<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Optimization models with `vjsim` • vjsim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Optimization models with `vjsim`">
<meta property="og:description" content="vjsim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vjsim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction-vjsim.html">Introduction to vjsim</a>
    </li>
    <li>
      <a href="../articles/simulation-vjsim.html">Simulation basic</a>
    </li>
    <li>
      <a href="../articles/profiling-vjsim.html">Profiling in vjsim</a>
    </li>
    <li>
      <a href="../articles/optimization-vjsim.html">Optimization with vjsim</a>
    </li>
    <li>
      <a href="../articles/exploring-vjsim.html">Exploring with vjsim</a>
    </li>
    <li>
      <a href="../articles/modeling-vjsim.html">Modeling with vjsim</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mladenjovanovic/vjsim/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="optimization-vjsim_files/header-attrs-2.1/header-attrs.js"></script><script src="optimization-vjsim_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="optimization-vjsim_files/jquery-1.12.4/jquery.min.js"></script><link href="optimization-vjsim_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="optimization-vjsim_files/datatables-binding-0.13/datatables.js"></script><link href="optimization-vjsim_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="optimization-vjsim_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="optimization-vjsim_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="optimization-vjsim_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="optimization-vjsim_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Optimization models with <code>vjsim</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mladenjovanovic/vjsim/blob/master/vignettes/optimization-vjsim.Rmd"><code>vignettes/optimization-vjsim.Rmd</code></a></small>
      <div class="hidden name"><code>optimization-vjsim.Rmd</code></div>

    </div>

    
    
<div id="introduction-to-samozino-et-al--method" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction-to-samozino-et-al--method" class="anchor"></a>Introduction to Samozino <em>et al.</em> method</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># Install vjsim if you haven't already by running the following commands</span>
<span class="co"># install.packages("devtools")</span>
<span class="co"># devtools::install_github("mladenjovanovic/vjsim")</span>

<span class="co"># Install tidyverse and cowplot packages</span>
<span class="co"># install.packages(c("tidyverse", "cowplot", "DT), dependencies = TRUE)</span>

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">vjsim</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cowplot</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DT</span>)</pre></body></html></div>
<p>Before reading this vignette, please read <a href="https://mladenjovanovic.github.io/vjsim/articles/introduction-vjsim.html">Introduction to vjsim</a>, <a href="https://mladenjovanovic.github.io/vjsim/articles/simulation-vjsim.html">Simulation in vjsim</a> and <a href="https://mladenjovanovic.github.io/vjsim/articles/profiling-vjsim.html">Profiling in vjsim</a> vignettes by running:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span>(<span class="st">"introduction-vjsim"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span>(<span class="st">"simulation-vjsim"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span>(<span class="st">"profiling-vjsim"</span>)</pre></body></html></div>
<p>This vignette is influenced with the works of Samozino, JB Morin <em>et al.</em> <span class="citation">(Samozino et al. <a href="#ref-samozinoSimpleMethodMeasuring2008" role="doc-biblioref">2008</a>, <a href="#ref-samozinoJumpingAbilityTheoretical2010" role="doc-biblioref">2010</a>, <a href="#ref-samozinoOptimalForceVelocity2012" role="doc-biblioref">2012</a>, <a href="#ref-samozinoForceVelocityProfileImbalance2013" role="doc-biblioref">2013</a>; Pierre Samozino <a href="#ref-samozinoOptimalForceVelocityProfile2018" role="doc-biblioref">2018</a><a href="#ref-samozinoOptimalForceVelocityProfile2018" role="doc-biblioref">b</a>, <a href="#ref-samozinoSimpleMethodMeasuring2018" role="doc-biblioref">2018</a><a href="#ref-samozinoSimpleMethodMeasuring2018" role="doc-biblioref">a</a>, <a href="#ref-samozinoSimpleMethodMeasuring2018" role="doc-biblioref">2018</a><a href="#ref-samozinoSimpleMethodMeasuring2018" role="doc-biblioref">a</a>)</span> and Jimenez-Reyes <em>et al.</em> <span class="citation">(Jiménez-Reyes et al. <a href="#ref-jimenez-reyesEffectivenessIndividualizedTraining2017" role="doc-biblioref">2017</a>; Jiménez-Reyes, Samozino, and Morin <a href="#ref-jimenez-reyesOptimizedTrainingJumping2019" role="doc-biblioref">2019</a>)</span>. I will provide a short summary and implementation in <code>vjsim</code> as well as some of my opinions regarding <em>Samozino optimization model</em>, but you are urged to check the references for more thorough information.</p>
<p>In the previous vignette <a href="https://mladenjovanovic.github.io/vjsim/articles/profiling-vjsim.html">Profiling in vjsim</a> I demonstrated the ideas behind Force-Velocity (FV) and Load-Velocity (LV) profiling and their implementation in <code>vjsim</code>, as well as the issues with those methods. This is relatively easy, since we are using simulated data. But collecting data on real athletes is harder, and <span class="citation">Samozino et al. (<a href="#ref-samozinoSimpleMethodMeasuring2008" role="doc-biblioref">2008</a>)</span> and <span class="citation">Samozino et al. (<a href="#ref-samozinoJumpingAbilityTheoretical2010" role="doc-biblioref">2010</a>)</span> created a simple method for estimating mean force and mean velocity from load~jump height profiling. To demonstrate how this works, and what are the assumptions of this model, I will used the profile from the previous vignette:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># External load in kilograms</span>
<span class="no">external_load</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span>)

<span class="no">profile_data</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/vj_profile.html">vj_profile</a></span>(
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="no">external_load</span>,

  <span class="co"># Simulation parameters</span>
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3000</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">4</span>

  <span class="co"># Other parameters are default in the `vjsim::fgen_get_output`</span>
  <span class="co"># weight = mass * gravity_const,</span>
  <span class="co"># gravity_const = 9.81,</span>
  <span class="co"># decline_rate = 1.05,</span>
  <span class="co"># peak_location = -push_off_distance * 0.15,</span>
  <span class="co"># time_to_max_activation = 0.3</span>
)</pre></body></html></div>
<p>As illustrated in the previous vignette, with <code>vjsim</code> we can create various FV profiles. But <span class="citation">Samozino et al. (<a href="#ref-samozinoSimpleMethodMeasuring2008" role="doc-biblioref">2008</a>)</span> and <span class="citation">Samozino et al. (<a href="#ref-samozinoJumpingAbilityTheoretical2010" role="doc-biblioref">2010</a>)</span> suggested a simple <em>field</em> method that can approximate mean force (<span class="math inline">\(\bar{F}\)</span>) and mean velocity (<span class="math inline">\(\bar{v}\)</span>) from a known (1) bodyweight, (2) jump height and (3) push-off distance. Otherwise, more expensive equipment, such as force place, is needed. The goal is to <em>approximate</em> laboratory Force-Velocity profiling using <em>field</em> Load-Height profile.</p>
<p>To represent jump, we will use introduced model in <code>vjsim</code>, where we have object of mass <span class="math inline">\(m\)</span>, that is accelerated over push-off distance (or height) <span class="math inline">\(h_{po}\)</span> by the action of the Force Generator, eventually reaching jump height <span class="math inline">\(h\)</span>. The jump is performed vertically, on Earth, where the gravity constant <span class="math inline">\(g\)</span> is equal to <span class="math inline">\(9.81ms^-2\)</span>. At the end of the push-off distance, object reaches the take-off velocity (<span class="math inline">\(TOV\)</span>, or <span class="math inline">\(v_{to}\)</span>), from which we can calculate height reached. Actually, in this field method, we calculate TOV from jump height reached using the inverse ballistic equation:</p>
<p><span class="math display">\[
v_{to} = \sqrt{2gh}
\]</span></p>
<p>For the object to reach jump height, Force Generator must do some <em>work</em>. Using the work (or energy) equation, we can derive mean force <span class="math inline">\(\bar{F}\)</span>. Please note that this mean force is <em>mean over distance</em> (see <a href="https://mladenjovanovic.github.io/vjsim/articles/introduction-vjsim.html">Introduction to vjsim</a>). Work done by the Force Generator is equal to weight of the object (i.e. <span class="math inline">\(mg\)</span>), multiplied by total distance, or sum of push-off distance and height reached (i.e. <span class="math inline">\(h_{po}+h\)</span>):</p>
<p><span class="math display">\[
W = mg(h_{po}+h)
\]</span></p>
<p>The above equation uses <em>potential energy</em>. We can also use potential plus kinetic energy form, where we sum the potential energy acquired by lifting the object for <span class="math inline">\(h_{po}\)</span> and kinetic energy using <span class="math inline">\(v_{to}\)</span>. These two equations are identical (actually this is how ballistic equation to get height from <span class="math inline">\(v_{to}\)</span> and <em>vice versa</em> is derived in the first place).</p>
<p><span class="math display">\[
W = mgh + \frac{mv_{to}^2}{2}
\]</span></p>
<p>Since work is equal <span class="math inline">\(F \times d\)</span>, and Force Generator acts only over the <span class="math inline">\(h_{po}\)</span>, we get the following equation for mean force <span class="math inline">\(\bar{F}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
W &amp;= \bar{F}\times h_{po} \\
\bar{F} &amp;= \frac{W}{h_{po}} \\
\bar{F} &amp;= \frac{mg(h_{po}+h)}{h_{po}} \\
\bar{F} &amp;= mg(\frac{h}{h_{po}}+1)
\end{aligned}
\]</span></p>
<p>Now we have the mean force acting over <span class="math inline">\(h_{po}\)</span>. But, how do we get the mean velocity <span class="math inline">\(\bar{v}\)</span> over <span class="math inline">\(h_{po}\)</span> (which is needed for FV profiling)?</p>
<p>The mean velocity over <span class="math inline">\(h_{po}\)</span> is equal to <span class="math inline">\(h_{po}\)</span> divided by the time it takes to cover it, or <span class="math inline">\(t_{po}\)</span>:</p>
<p><span class="math display">\[
\bar{v} = \frac{h_{po}}{t_{po}}
\]</span></p>
<p>Unfortunately, we do not know <span class="math inline">\(t_{po}\)</span> (using this simple field approach). What <span class="citation">Samozino et al. (<a href="#ref-samozinoSimpleMethodMeasuring2008" role="doc-biblioref">2008</a>)</span> and <span class="citation">Samozino et al. (<a href="#ref-samozinoJumpingAbilityTheoretical2010" role="doc-biblioref">2010</a>)</span> have done (see <span class="citation">Samozino et al. (<a href="#ref-samozinoSimpleMethodMeasuring2008" role="doc-biblioref">2008</a>)</span> page 2941, equation 6) is to use impulse-momentum equation, which states that impulse (<span class="math inline">\(I = (\bar{F} - mg) \times t_{po}\)</span>) is equal to the momentum (<span class="math inline">\(M = m \times v_{to}\)</span>). We thus get the following equation, from which we can extract <span class="math inline">\(t_{po}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
  I &amp;= M \\
  (\bar{F} - mg) \times t_{po} &amp;= m \times v_{to} \\
  t_{po} &amp;= \frac{m \times v_{to}}{\bar{F} - mg}
\end{aligned}
\]</span></p>
<p>If we use the equation that <span class="math inline">\(v_{to} = \sqrt{2gh}\)</span>, we get the following equation for <span class="math inline">\(\bar{v}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
  \bar{v} &amp;= \frac{h_{po}}{t_{po}} \\
  \bar{v} &amp;= \frac{h_{po}}{\frac{m \times v_{to}}{\bar{F} - mg}} \\
  \bar{v} &amp;= \frac{h_{po}}{\frac{m \times v_{to}}{mg(\frac{h}{h_{po}}+1) - mg}} \\
  \bar{v} &amp;= \frac{h_{po}}{\frac{m \times v_{to}}{\frac{mgh}{h_{po}}}} \\
  \bar{v} &amp;= \frac{gh}{v_{to}} \\
\end{aligned}
\]</span></p>
<p>We can now use <span class="math inline">\(v_{to} = \sqrt{2gh}\)</span> to solve this equation:</p>
<p><span class="math display">\[
\begin{aligned}
  \bar{v} &amp;= \frac{gh}{v_{to}} \\
   \bar{v} &amp;= \frac{gh}{\sqrt{2gh}} \\
   \bar{v} &amp;= \sqrt{\frac{gh}{2}}
\end{aligned}
\]</span></p>
<p>This also implies that <span class="math inline">\(\frac{v_{to}}{\bar{v}}\)</span> is equal to:</p>
<p><span class="math display">\[
\begin{aligned}
  \frac{v_{to}}{\bar{v}} &amp;= \\
  \frac{\sqrt{2gh}}{\sqrt{\frac{gh}{2}}} &amp;= \\
  &amp;= 2
\end{aligned}
\]</span></p>
<p>Why is this? Because, equations used by <span class="citation">Samozino et al. (<a href="#ref-samozinoSimpleMethodMeasuring2008" role="doc-biblioref">2008</a>)</span> and <span class="citation">Samozino et al. (<a href="#ref-samozinoJumpingAbilityTheoretical2010" role="doc-biblioref">2010</a>)</span> assumes same <span class="math inline">\(\bar{F}\)</span> over distance (estimated using Work/Energy equations) and <span class="math inline">\(\bar{F}\)</span> over time (estimated using Impulse - Momentum equations). This assumption is only valid when there is constant force applied and there is uniform acceleration. In that case (assuming starting velocity to be equal to 0 m/s), <span class="math inline">\(v_{to}\)</span> is twice as big as <span class="math inline">\(\bar{v}\)</span>.</p>
<p>In short, field method proposed by <span class="citation">Samozino et al. (<a href="#ref-samozinoSimpleMethodMeasuring2008" role="doc-biblioref">2008</a>)</span> and <span class="citation">Samozino et al. (<a href="#ref-samozinoJumpingAbilityTheoretical2010" role="doc-biblioref">2010</a>)</span> approximates <span class="math inline">\(\bar{F}\)</span> and <span class="math inline">\(\bar{v}\)</span> assuming constant force and is uniform acceleration across <span class="math inline">\(h_{po}\)</span>. Although wrong, the error introduced by this assumption is estimated in the aforementioned studies when compared with laboratory measurement and it doesn’t seem to be practically significant. But this error (or assumption) simplifies the estimation of <span class="math inline">\(\bar{F}\)</span> and <span class="math inline">\(\bar{v}\)</span> in the field settings.</p>
<p>In <code>vjsim</code> this method of profiling is implemented using <em>true</em> <span class="math inline">\(\bar{v}\)</span> and mean GRF over distance (<span class="math inline">\(\bar{F}\)</span>), which I called <em>theoretical</em> (and thus represent Mean Force ~ Mean Velocity profile) and using <span class="math inline">\(\frac{1}{2}v_{to}\)</span> as <span class="math inline">\(\bar{v}\)</span>, which I called <em>practical</em>. We will explore their similarities and differences in this and the next vignette. Here is how these are calculated in <code>vjsim</code> (focus on <span class="math inline">\(F_0\)</span> and <span class="math inline">\(V_0\)</span> and disregard <em>optimal</em> metrics for now - they will soon be explained):</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">samozino_profiles</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>(<span class="no">profile_data</span>)


<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="no">samozino_profiles</span>$<span class="no">data_frame</span>, <span class="kw">rownames</span> <span class="kw">=</span> <span class="fl">FALSE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html">formatRound</a></span>(<span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">samozino_profiles</span>$<span class="no">data_frame</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<div id="htmlwidget-7adf96e7eb19c8f6693b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7adf96e7eb19c8f6693b">{"x":{"filter":"none","data":[["Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile"],["F0","F0_rel","V0","Pmax","Pmax_rel","Sfv","Sfv_rel","take_off_velocity","height","optimal_F0","optimal_F0_rel","optimal_V0","optimal_height","optimal_height_diff","optimal_height_ratio","optimal_Pmax","optimal_Pmax_rel","optimal_take_off_velocity","optimal_take_off_velocity_diff","optimal_take_off_velocity_ratio","optimal_Sfv","optimal_Sfv_rel","Sfv_perc","FV_imbalance","probe_IMB","F0","F0_rel","V0","Pmax","Pmax_rel","Sfv","Sfv_rel","take_off_velocity","height","optimal_F0","optimal_F0_rel","optimal_V0","optimal_height","optimal_height_diff","optimal_height_ratio","optimal_Pmax","optimal_Pmax_rel","optimal_take_off_velocity","optimal_take_off_velocity_diff","optimal_take_off_velocity_ratio","optimal_Sfv","optimal_Sfv_rel","Sfv_perc","FV_imbalance","probe_IMB"],[2690.724579738,35.8763277298399,2.52862445537967,1700.95799375417,22.6794399167223,-1064.10604944259,-14.1880806592346,2.53873276825153,0.328499697685733,2679.98861369844,35.7331815159792,2.5387540604612,0.328505218243426,5.52055769265092e-06,1.00001680536613,1700.95799375417,22.6794399167223,2.53875410032875,2.13320772131098e-05,1.00000840264776,-1055.63144356393,-14.0750859141857,100.802799682629,0.802799682628996,101.206225038384,3254.31395034112,43.3908526712149,2.02110478027624,1644.32737038852,21.9243649385136,-1610.16587665303,-21.4688783553737,2.43684032231585,0.3026600793305,2637.520435744,35.1669391432534,2.49374730615072,0.31696104185445,0.0143009625239501,1.04725090456457,1644.32737038852,21.9243649385136,2.49374730900793,0.0569069866920846,1.02335277620407,-1057.65344758014,-14.1020459677352,152.239458050934,52.2394580509341,155.062046401594]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>profile<\/th>\n      <th>metric<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[0,1,2],"render":"function(data, type, row, meta) { return DTWidget.formatRound(data, 2, 3, \",\", \".\"); }"},{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script><p>Here is the plot of these two profiles:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">profile</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Theoretical"</span>, <span class="st">"Practical"</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">2</span>),
  <span class="kw">group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fl">2</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">2</span>),
  <span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">samozino_profiles</span>$<span class="no">list</span>$<span class="no">samozino_theoretical_profile</span>$<span class="no">F0</span>, <span class="fl">0</span>, <span class="no">samozino_profiles</span>$<span class="no">list</span>$<span class="no">samozino_practical_profile</span>$<span class="no">F0</span>, <span class="fl">0</span>),
  <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="no">samozino_profiles</span>$<span class="no">list</span>$<span class="no">samozino_theoretical_profile</span>$<span class="no">V0</span>, <span class="fl">0</span>, <span class="no">samozino_profiles</span>$<span class="no">list</span>$<span class="no">samozino_practical_profile</span>$<span class="no">V0</span>)
)

<span class="no">plot_data_points</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Theoretical"</span>,
    <span class="kw">group</span> <span class="kw">=</span> <span class="fl">1</span>,
    <span class="kw">x</span> <span class="kw">=</span> <span class="no">profile_data</span>$<span class="no">mean_GRF_over_distance</span>,
    <span class="kw">y</span> <span class="kw">=</span> <span class="no">profile_data</span>$<span class="no">mean_velocity</span>
  ),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Practical"</span>,
    <span class="kw">group</span> <span class="kw">=</span> <span class="fl">2</span>,
    <span class="kw">x</span> <span class="kw">=</span> <span class="no">profile_data</span>$<span class="no">mean_GRF_over_distance</span>,
    <span class="kw">y</span> <span class="kw">=</span> <span class="no">profile_data</span>$<span class="no">mean_velocity_as_TOV_half</span>
  )
)

<span class="fu">ggplot</span>(<span class="no">plot_data</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">group</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">profile</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
  <span class="fu">geom_point</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">plot_data_points</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Mean GRF over distance (N)"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Mean Velocity (m/s)"</span>)</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="effect-of-barf-on-jump-height" class="section level1">
<h1 class="hasAnchor">
<a href="#effect-of-barf-on-jump-height" class="anchor"></a>Effect of <span class="math inline">\(\bar{F}\)</span> on jump height</h1>
<p>If mean force <span class="math inline">\(\bar{F}\)</span> acts on the body of mass <span class="math inline">\(m\)</span>, weight <span class="math inline">\(w=mg\)</span> over a push-off distance <span class="math inline">\(h_{po}\)</span>, starting with initial velocity <span class="math inline">\(v=0\)</span>, then the final take-off velocity reached <span class="math inline">\(v_{to}\)</span> is equal to:</p>
<p><span class="math display">\[
\begin{aligned}
  (\bar{F} - mg)\times h_{po} &amp;= \frac{v_{to}^2}{2} \\
  v_{to} &amp;= \sqrt{\frac{2h_{po}(\bar{F} - mg)}{m}}
\end{aligned}
\]</span></p>
<p>Assuming athlete weights 75kg, we get the following graph for varying <span class="math inline">\(h_{po}\)</span> and <span class="math inline">\(\bar{F}\)</span></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># Need this package to label the lines</span>
<span class="co"># install.packages("directlabels")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="no">directlabels</span>)

<span class="co"># Function to calculate TOV</span>
<span class="no">get_tov</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">mass</span>, <span class="no">gravity_const</span>, <span class="no">mean_force</span>, <span class="no">push_off_distance</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>((<span class="fl">2</span> * <span class="no">push_off_distance</span> * (<span class="no">mean_force</span> - <span class="no">mass</span> * <span class="no">gravity_const</span>)) / <span class="no">mass</span>)
}

<span class="no">params</span> <span class="kw">&lt;-</span> <span class="fu">expand_grid</span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">gravity_const</span> <span class="kw">=</span> <span class="fl">9.81</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>),
  <span class="kw">mean_GRF_over_distance</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">3000</span>)
)

<span class="no">params</span>$<span class="no">take_off_velocity</span> <span class="kw">&lt;-</span> <span class="fu">get_tov</span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="no">params</span>$<span class="no">mass</span>,
  <span class="kw">gravity_const</span> <span class="kw">=</span> <span class="no">params</span>$<span class="no">gravity_const</span>,
  <span class="kw">mean_force</span> <span class="kw">=</span> <span class="no">params</span>$<span class="no">mean_GRF_over_distance</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="no">params</span>$<span class="no">push_off_distance</span>
)

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">params</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">mean_GRF_over_distance</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">take_off_velocity</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">push_off_distance</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">push_off_distance</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>(<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>) +
  <span class="fu">scale_color_gradient</span>(<span class="kw">low</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">high</span> <span class="kw">=</span> <span class="st">"black"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.6</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>As can be seen from this graph, higher the <span class="math inline">\(\bar{F}\)</span>, the higher the <span class="math inline">\(v_{to}\)</span> reached. The same thing with <span class="math inline">\(h_{po}\)</span>. If the <span class="math inline">\(\bar{F}\)</span> is below <span class="math inline">\(mg\)</span> (in this case 735.75N), then there will be no jump at all, since force acting on the object is lower than object’s weight. We can also do this for the jump height, rather than <span class="math inline">\(v_{to}\)</span>:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">params</span>$<span class="no">height</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_height.html">get_height</a></span>(<span class="no">params</span>$<span class="no">take_off_velocity</span>, <span class="no">params</span>$<span class="no">gravity_const</span>)

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">params</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">mean_GRF_over_distance</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">height</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">push_off_distance</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">push_off_distance</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>(<span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>) +
  <span class="fu">scale_color_gradient</span>(<span class="kw">low</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">high</span> <span class="kw">=</span> <span class="st">"black"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.6</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Long story short, assuming <span class="math inline">\(h_{po}\)</span> is fixed, the more force one applies (particularly relative force, i.e. <span class="math inline">\(\frac{\bar{F}}{m}\)</span>), the higher the jump. Rocket science!</p>
</div>
<div id="adding-force-generator-constraints" class="section level1">
<h1 class="hasAnchor">
<a href="#adding-force-generator-constraints" class="anchor"></a>Adding Force Generator ‘constraints’</h1>
<p>One of the premise of Samozino’s model is that the previous mechanical constraints (<span class="math inline">\(v_{to}\)</span> increasing with <span class="math inline">\(\bar{F}\)</span>) can be combined with FV relationship of the Force Generator (i.e. <span class="math inline">\(F_0\)</span> and <span class="math inline">\(V_0\)</span>). As previously explained, Samozino’s model assumes that <span class="math inline">\(\bar{v}\)</span> is equal to <span class="math inline">\(\frac{v_{to}}{2}\)</span>. Thus we get the following figure (using 75kg bodyweight and <span class="math inline">\(h_{po}\)</span> of 0.4m:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">params</span>$<span class="no">mean_velocity_as_TOV_half</span> <span class="kw">&lt;-</span> <span class="no">params</span>$<span class="no">take_off_velocity</span> / <span class="fl">2</span>

<span class="fu">ggplot</span>(
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">plot_data</span>, <span class="no">profile</span> <span class="kw">==</span> <span class="st">"Practical"</span>),
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">group</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">profile</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Mean GRF over distance (N)"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Mean Velocity (m/s)"</span>) +
  <span class="fu">geom_line</span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">params</span>, <span class="no">push_off_distance</span> <span class="kw">==</span> <span class="fl">0.4</span>),
    <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">mean_GRF_over_distance</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">mean_velocity_as_TOV_half</span>), <span class="kw">group</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>
  )</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The predicted <span class="math inline">\(\hat{v_{to}}\)</span> (referenced papers refer to this as <em>maximal <span class="math inline">\(v_{to}\)</span></em>, but I do not like the name, so I just refer to it as take-off velocity) is the point where two profiles intersect. This point can mathematically be expressed as:</p>
<p><span class="math display">\[
\hat{v_{to}} = \frac{h_{po}\left(\sqrt{\left(\frac{F_0^2}{4 V_0^2}-\frac{2 m (g
   m-F_0)}{h_{po}}\right)}-\frac{F_0}{2 V_0}\right)}{m}
\]</span></p>
<p>This equation is implemented in <code><a href="../reference/get_samozino_take_off_velocity.html">vjsim::get_samozino_take_off_velocity</a></code> function, that we will shortly use.</p>
<p>Look at <span class="math inline">\(\hat{v_{to}}\)</span> this way - given the FV characteristic of the individual (as well as his/her bodyweight, <span class="math inline">\(h_{po}\)</span> and of course gravity constant) we can <em>predict</em> take-off velocity and height. Thus, this is a model prediction.</p>
<p>As already explained, in <code>vjsim</code> we can implement practical Samozino profile (approximating mean velocity with half of TOV) and theoretical profile (using <em>true</em> mean velocity over <span class="math inline">\(h_{po}\)</span>). We can plot these and see that the model <span class="math inline">\(v_{to}\)</span> predictions differ, but they are both quite close to the first data point (i.e. bodyweight jump performance):</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu">ggplot</span>(<span class="no">plot_data</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">group</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">profile</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
  <span class="fu">geom_point</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">plot_data_points</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Mean GRF over distance (N)"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Mean Velocity (m/s)"</span>) +
  <span class="fu">geom_line</span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">params</span>, <span class="no">push_off_distance</span> <span class="kw">==</span> <span class="fl">0.4</span>),
    <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">mean_GRF_over_distance</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">mean_velocity_as_TOV_half</span>), <span class="kw">group</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>
  )</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The differences between true jump height or true take-off velocity and model predicted can be traced back to the ratio between take-off velocity and mean velocity (since Samozino’s model assumes uniform acceleration and 2:1 ratio between these two). This is something we will explore in the next vignette.</p>
<p>This model might seems a bit <em>circular</em>, and that is one of my arguments against it. We use load and jump height performance to infer <span class="math inline">\(F_0\)</span> and <span class="math inline">\(V_0\)</span>, from which we predict jump height. Besides, we estimate Force Generator constraints or determinants of performance (in this case jump height) from the performance itself. Then we claim that <span class="math inline">\(F_0\)</span> and <span class="math inline">\(V_0\)</span> determine jump performance (which we estimated from performance itself in the first place)?!</p>
<p>As seen in this and previous vignette, these parameters doesn’t recover true Force Generator characteristic. Here I highly agree with the comment by <span class="citation">Cleather (<a href="#ref-cleatherForcevelocityProfilingMisnomer2019" role="doc-biblioref">2019</a>)</span> that we need to refer to this as “Load-jump height profile”. I will come back to further critique in the next vignette, so let’s continue exploring this model.</p>
</div>
<div id="optimization" class="section level1">
<h1 class="hasAnchor">
<a href="#optimization" class="anchor"></a>Optimization</h1>
<p>“What should I be working on to increase my jump height?” is the question we as coaches often get. From the ballistic equation, the answer is simple - increase the force applied to the ground (or force impulse). But how should this be done? Should athlete focus on high-loads and low-velocity activities or low-load high-velocity activities?</p>
<p>Samozino’s model approach answering this question by making few assumptions. First, model assumes that <span class="math inline">\(F_0\)</span> and <span class="math inline">\(V_0\)</span> represent true Force Generator profile (mechanical) characteristics (but as seen they represent <em>manifested</em> and extrapolated characteristics given <span class="math inline">\(h_{po}\)</span> and bodyweight, rather than <em>ontological truth</em>). Second, they make assumption that max power <span class="math inline">\(P_{max}\)</span>, which is equal to <span class="math inline">\(\frac{F_0 \times V_0}{4}\)</span> represent some <em>ontological</em> characteristic of the Force Generator (again, rather than manifested performance metric for a given conditions). Third, model assumes that there are “force” and “velocity” capabilities of the entire lower extremities, and thus that there are training methods to <em>hit</em> those qualities. For example, one might improve <em>force</em> characteristics or <em>velocity</em> characteristics of the Force Generator.</p>
<p>Philosophically, these represent <em>realist</em> positions, where these metrics (i.e., <span class="math inline">\(F_0\)</span>, <span class="math inline">\(V_0\)</span>, and <span class="math inline">\(P_{max}\)</span>) are treated as <em>real</em> mechanical characteristics of the Force Generator and thus represent <em>determinants</em> of performance that can be directly affected with specific training interventions. These implications will be explained and critiqued thorough this and next vignette. For now, let’s maintain this assumption.</p>
<p>According to Samozino <em>et al.</em>, <span class="math inline">\(P_{max}\)</span> is the determinant mechanical characteristic of the Force Generator. Additional, and assumed to be independent determinant, is the slope of the FV curve <span class="math inline">\(S_{FV}\)</span>:</p>
<p><span class="math display">\[
S_{FV} = -\frac{F_0}{V_0}
\]</span></p>
<p>Thus, one can either use <span class="math inline">\(F_0\)</span> and <span class="math inline">\(V_0\)</span>, or <span class="math inline">\(P_{max}\)</span> and <span class="math inline">\(S_{FV}\)</span> to represent mechanical characteristics of the Force Generator.</p>
<p>Similarly to the probing we did in the previous vignettes (e.g., how does increasing max force, max velocity or time to max activation affects the jump performance or the profile, <em>while keeping everything else the same</em>), we can ask ourselves the following question: “Assuming the <span class="math inline">\(P_{max}\)</span> stays the same, but we change the <span class="math inline">\(S_{FV}\)</span>, can we increase the predicted jump height or take-off velocity?”</p>
<p>What does this mean? It is easier to understand it graphically. Let’s use the hypothetical profile where <span class="math inline">\(F_0\)</span> is equal to 3,000N and <span class="math inline">\(V_0\)</span> is equal to 2m/s. Push-off distance <span class="math inline">\(h_{po}\)</span> is equal to 0.4m and bodyweight is equal to 75kg (gravity constants is of course, <span class="math inline">\(9.81ms^-2\)</span>).</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3000</span>, <span class="fl">0</span>),
  <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">2</span>)
)

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">plot_data</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>(<span class="kw">color</span> <span class="kw">=</span> <span class="st">"blue"</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
  <span class="fu">geom_line</span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">params</span>, <span class="no">push_off_distance</span> <span class="kw">==</span> <span class="fl">0.4</span>),
    <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">mean_GRF_over_distance</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">mean_velocity_as_TOV_half</span>),
    <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>
  ) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Mean GRF over distance (N)"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Mean Velocity (m/s)"</span>)

<span class="no">gg</span></pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Max power and slope of this profile are equal to:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_max_power.html">get_max_power</a></span>(<span class="fl">3000</span>, <span class="fl">2</span>)
<span class="co">#&gt; [1] 1500</span>
<span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_slope.html">get_slope</a></span>(<span class="fl">3000</span>, <span class="fl">2</span>)
<span class="co">#&gt; [1] -1500</span></pre></body></html></div>
<p>Predicted <span class="math inline">\(v_{to}\)</span> is equal to:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_samozino_take_off_velocity.html">get_samozino_take_off_velocity</a></span>(
  <span class="kw">F0</span> <span class="kw">=</span> <span class="fl">3000</span>, <span class="kw">V0</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">bodyweight</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">gravity_const</span> <span class="kw">=</span> <span class="fl">9.81</span>
)
<span class="co">#&gt; [1] 2.336561</span></pre></body></html></div>
<p>Here comes the <em>probing</em> question: “If we assume <span class="math inline">\(P_{max}\)</span> stays the same, can we <em>tilt</em> the FV profile so that take-off velocity is maximized (for a given <span class="math inline">\(P_{max}\)</span>)?”.</p>
<p>But how do we <em>tilt</em> the FV curve without affecting <span class="math inline">\(P_{max}\)</span>? If you look at the equation for <span class="math inline">\(P_{max}\)</span>, which is <span class="math inline">\(\frac{F_0 \times V_0}{4}\)</span>, we tilt the slope by multiplying <span class="math inline">\(F_0\)</span> by a specific factor <span class="math inline">\(k\)</span>, while simultaneously dividing <span class="math inline">\(V_0\)</span> by the same factor. This way <span class="math inline">\(P_{max}\)</span> stays the same, while we tilt the FV curve.</p>
<p>Here is the code and graphical representation using <span class="math inline">\(k\)</span> of 0.8, 0.9, 1, 1.1, 1.2:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>)

<span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu">tibble</span>(
  <span class="kw">k</span> <span class="kw">=</span> <span class="no">k</span>,
  <span class="kw">F0</span> <span class="kw">=</span> <span class="fl">3000</span> * <span class="no">k</span>,
  <span class="kw">V0</span> <span class="kw">=</span> <span class="fl">2</span> / <span class="no">k</span>,
  <span class="kw">max_power</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_max_power.html">get_max_power</a></span>(<span class="no">F0</span>, <span class="no">V0</span>),
  <span class="kw">slope</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_slope.html">get_slope</a></span>(<span class="no">F0</span>, <span class="no">V0</span>),
  <span class="kw">predicted_TOV</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_samozino_take_off_velocity.html">get_samozino_take_off_velocity</a></span>(<span class="no">F0</span>, <span class="no">V0</span>, <span class="fl">75</span>, <span class="fl">0.4</span>, <span class="fl">9.81</span>),
  <span class="kw">group</span> <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">x</span> <span class="kw">=</span> <span class="no">F0</span>,
  <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0</span>,
)

<span class="no">plot_data_2</span> <span class="kw">&lt;-</span> <span class="no">plot_data</span>
<span class="no">plot_data_2</span>$<span class="no">group</span> <span class="kw">&lt;-</span> <span class="fl">2</span>
<span class="no">plot_data_2</span>$<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">plot_data_2</span>$<span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">plot_data_2</span>$<span class="no">V0</span>

<span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="no">plot_data</span>,
  <span class="no">plot_data_2</span>
)

<span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="no">plot_data</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(
    <span class="kw">k</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">k</span>)
  )

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">plot_data</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">k</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">slope</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"blue"</span>) +
  <span class="fu">geom_line</span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">params</span>, <span class="no">push_off_distance</span> <span class="kw">==</span> <span class="fl">0.4</span>),
    <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">mean_GRF_over_distance</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">mean_velocity_as_TOV_half</span>),
    <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"black"</span>
  ) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Mean GRF over distance (N)"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Mean Velocity (m/s)"</span>) +
  <span class="fu">scale_color_gradient</span>(<span class="kw">low</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">high</span> <span class="kw">=</span> <span class="st">"black"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.points"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.5</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Each profile line on the previous figure has the same <span class="math inline">\(P_{max}\)</span>, but different slope. The original slope is equal to -1500, but as can be seen from the figure, according to this model, take-off velocity would be maximized when slope is -960. According to this model, this implies improving “velocity” characteristics of the Force Generator (whatever that might be). In coaches language, this individual should improve his “velocity” characteristics to improve take-off velocity and jump height.</p>
<p>We can represent these FV profiles with different slopes (but same <span class="math inline">\(P_{max}\)</span>) with this figure:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu">tibble</span>(
  <span class="kw">k</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">100</span>),
  <span class="kw">F0</span> <span class="kw">=</span> <span class="fl">3000</span> * <span class="no">k</span>,
  <span class="kw">V0</span> <span class="kw">=</span> <span class="fl">2</span> / <span class="no">k</span>,
  <span class="kw">slope</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_slope.html">get_slope</a></span>(<span class="no">F0</span>, <span class="no">V0</span>),
  <span class="kw">predicted_TOV</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_samozino_take_off_velocity.html">get_samozino_take_off_velocity</a></span>(<span class="no">F0</span>, <span class="no">V0</span>, <span class="fl">75</span>, <span class="fl">0.4</span>, <span class="fl">9.81</span>),
  <span class="kw">predicted_height</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_height.html">get_height</a></span>(<span class="no">predicted_TOV</span>)
)

<span class="fu">ggplot</span>(<span class="no">plot_data</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">slope</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">predicted_TOV</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>()</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>There is algebraic solution to this problem of finding <span class="math inline">\(S_{fv}{opt}\)</span> (that maximizes <span class="math inline">\(v_{to}\)</span>), but in <code><a href="../reference/get_samozino_optimal_profile.html">vjsim::get_samozino_optimal_profile</a></code> function I have used the <code>optim</code> function to find the slope that maximizes the take-off velocity while maintaining the <span class="math inline">\(P_{max}\)</span>:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_samozino_optimal_profile.html">get_samozino_optimal_profile</a></span>(
  <span class="kw">F0</span> <span class="kw">=</span> <span class="fl">3000</span>,
  <span class="kw">V0</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">bodyweight</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">gravity_const</span> <span class="kw">=</span> <span class="fl">9.81</span>
)
<span class="co">#&gt; $F0</span>
<span class="co">#&gt; [1] 3000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $F0_rel</span>
<span class="co">#&gt; [1] 40</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $V0</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Pmax</span>
<span class="co">#&gt; [1] 1500</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Pmax_rel</span>
<span class="co">#&gt; [1] 20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Sfv</span>
<span class="co">#&gt; [1] -1500</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Sfv_rel</span>
<span class="co">#&gt; [1] -20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $take_off_velocity</span>
<span class="co">#&gt; [1] 2.336561</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $height</span>
<span class="co">#&gt; [1] 0.2782628</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_F0</span>
<span class="co">#&gt; [1] 2527.841</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_F0_rel</span>
<span class="co">#&gt; [1] 33.70455</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_V0</span>
<span class="co">#&gt; [1] 2.373567</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_height</span>
<span class="co">#&gt; [1] 0.2871468</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_height_diff</span>
<span class="co">#&gt; [1] 0.008884008</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_height_ratio</span>
<span class="co">#&gt; [1] 1.031927</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_Pmax</span>
<span class="co">#&gt; [1] 1500</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_Pmax_rel</span>
<span class="co">#&gt; [1] 20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_take_off_velocity</span>
<span class="co">#&gt; [1] 2.373567</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_take_off_velocity_diff</span>
<span class="co">#&gt; [1] 0.03700627</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_take_off_velocity_ratio</span>
<span class="co">#&gt; [1] 1.015838</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_Sfv</span>
<span class="co">#&gt; [1] -1064.997</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_Sfv_rel</span>
<span class="co">#&gt; [1] -14.19996</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Sfv_perc</span>
<span class="co">#&gt; [1] 140.8455</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FV_imbalance</span>
<span class="co">#&gt; [1] 40.84549</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $probe_IMB</span>
<span class="co">#&gt; [1] 143.3826</span></pre></body></html></div>
<p><code><a href="../reference/get_samozino_optimal_profile.html">vjsim::get_samozino_optimal_profile</a></code> spits out multiple summaries, both original and <em>optimized</em>. To compare <span class="math inline">\(S_{fv}\)</span> and <span class="math inline">\(S_{fv}^{optimal}\)</span>, Samozino suggested used two metrics, <span class="math inline">\(S_{FV}\%\)</span> and <span class="math inline">\(FV_{IMB}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
  S_{FV}\% &amp;= 100 \times \frac{S_{FV}}{S_{fv}{opt}} \\
  FV_{IMB} &amp;= 100\times |1 - \frac{S_{FV}}{S_{fv}{opt}}|
\end{aligned}
\]</span></p>
<p>According to Samozino <em>et al.</em>, <span class="math inline">\(S_{FV}\%\)</span> over 100% represents FV profile too much oriented towards “force”, which implies “velocity” deficit (and the individual should spend more time fixing “velocity” deficit by performing low-load high-speed activities). When <span class="math inline">\(S_{FV}\%\)</span> is under 100%, it represents FV profile that is too much oriented towards “velocity”, which implies “force” deficit (and the individual should spend more time fixing “force” deficit by performing high-load low-speed activities).</p>
<p><span class="math inline">\(FV_{IMB}\)</span> represents an absolute measure of this <em>imbalance</em> without a direction, where 0 represents optimal profile.</p>
<p>These summaries are automatically computed using <code><a href="../reference/get_all_samozino_profiles.html">vjsim::get_all_samozino_profiles</a></code> for both practical and theoretical profiles.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">samozino_profiles</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>(<span class="no">profile_data</span>)


<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="no">samozino_profiles</span>$<span class="no">data_frame</span>, <span class="kw">rownames</span> <span class="kw">=</span> <span class="fl">FALSE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html">formatRound</a></span>(<span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">samozino_profiles</span>$<span class="no">data_frame</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<div id="htmlwidget-030ca3ca1bc4ce97e3ea" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-030ca3ca1bc4ce97e3ea">{"x":{"filter":"none","data":[["Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino practical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile","Samozino theoretical profile"],["F0","F0_rel","V0","Pmax","Pmax_rel","Sfv","Sfv_rel","take_off_velocity","height","optimal_F0","optimal_F0_rel","optimal_V0","optimal_height","optimal_height_diff","optimal_height_ratio","optimal_Pmax","optimal_Pmax_rel","optimal_take_off_velocity","optimal_take_off_velocity_diff","optimal_take_off_velocity_ratio","optimal_Sfv","optimal_Sfv_rel","Sfv_perc","FV_imbalance","probe_IMB","F0","F0_rel","V0","Pmax","Pmax_rel","Sfv","Sfv_rel","take_off_velocity","height","optimal_F0","optimal_F0_rel","optimal_V0","optimal_height","optimal_height_diff","optimal_height_ratio","optimal_Pmax","optimal_Pmax_rel","optimal_take_off_velocity","optimal_take_off_velocity_diff","optimal_take_off_velocity_ratio","optimal_Sfv","optimal_Sfv_rel","Sfv_perc","FV_imbalance","probe_IMB"],[2690.724579738,35.8763277298399,2.52862445537967,1700.95799375417,22.6794399167223,-1064.10604944259,-14.1880806592346,2.53873276825153,0.328499697685733,2679.98861369844,35.7331815159792,2.5387540604612,0.328505218243426,5.52055769265092e-06,1.00001680536613,1700.95799375417,22.6794399167223,2.53875410032875,2.13320772131098e-05,1.00000840264776,-1055.63144356393,-14.0750859141857,100.802799682629,0.802799682628996,101.206225038384,3254.31395034112,43.3908526712149,2.02110478027624,1644.32737038852,21.9243649385136,-1610.16587665303,-21.4688783553737,2.43684032231585,0.3026600793305,2637.520435744,35.1669391432534,2.49374730615072,0.31696104185445,0.0143009625239501,1.04725090456457,1644.32737038852,21.9243649385136,2.49374730900793,0.0569069866920846,1.02335277620407,-1057.65344758014,-14.1020459677352,152.239458050934,52.2394580509341,155.062046401594]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>profile<\/th>\n      <th>metric<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[0,1,2],"render":"function(data, type, row, meta) { return DTWidget.formatRound(data, 2, 3, \",\", \".\"); }"},{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script><p>Rather than maintaining <span class="math inline">\(P_{max}\)</span> we can probe this by alternating increasing <span class="math inline">\(F_0\)</span> or <span class="math inline">\(V_0\)</span> by 10% to check which one provides more increasing take-off velocity:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">tov</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_samozino_take_off_velocity.html">get_samozino_take_off_velocity</a></span>(
  <span class="kw">F0</span> <span class="kw">=</span> <span class="fl">3000</span>,
  <span class="kw">V0</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">bodyweight</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">gravity_const</span> <span class="kw">=</span> <span class="fl">9.81</span>
)
<span class="no">tov</span>
<span class="co">#&gt; [1] 2.336561</span>

<span class="no">tov_velocity</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_samozino_take_off_velocity.html">get_samozino_take_off_velocity</a></span>(
  <span class="kw">F0</span> <span class="kw">=</span> <span class="fl">3000</span>,
  <span class="kw">V0</span> <span class="kw">=</span> <span class="fl">2</span> * <span class="fl">1.1</span>,
  <span class="kw">bodyweight</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">gravity_const</span> <span class="kw">=</span> <span class="fl">9.81</span>
)
<span class="no">tov_velocity</span>
<span class="co">#&gt; [1] 2.477157</span>

<span class="no">tov_force</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_samozino_take_off_velocity.html">get_samozino_take_off_velocity</a></span>(
  <span class="kw">F0</span> <span class="kw">=</span> <span class="fl">3000</span> * <span class="fl">1.1</span>,
  <span class="kw">V0</span> <span class="kw">=</span> <span class="fl">2</span>,
  <span class="kw">bodyweight</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">gravity_const</span> <span class="kw">=</span> <span class="fl">9.81</span>
)
<span class="no">tov_force</span>
<span class="co">#&gt; [1] 2.434618</span></pre></body></html></div>
<p>If <span class="math inline">\(V_0\)</span> increases for 10% (to 2.2m/s), take-off velocity will increase for 6.02%. If <span class="math inline">\(F0\)</span> increases for 10% (to 3300N), take-off velocity will increase for 4.2%. Thus, increasing “velocity” seems better investment (assuming same effort to improve parameters for 10%), which is same conclusion with the previous optimal slope approach. We can use another metric using these two probing values:</p>
<p><span class="math display">\[
probe_{IMB} = \frac{v_{to}^{10\%velocity} - v_{to}}{v_{to}^{10\%force} - v_{to}} \times 100
\]</span></p>
<p>Using the above values, <span class="math inline">\(probe_{IMB}\)</span> is equal to 143.38%, which is similar to <span class="math inline">\(S_{FV}\%\)</span>, just created different way.</p>
<p>We can also plot this probe (use the code below or <code><a href="../reference/probe_samozino_take_off_velocity.html">vjsim::probe_samozino_take_off_velocity</a></code> function):</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_probing_data.html">get_probing_data</a></span>(
  <span class="kw">args_list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">F0</span> <span class="kw">=</span> <span class="fl">3000</span>, <span class="kw">V0</span> <span class="kw">=</span> <span class="fl">2</span>),
  <span class="kw">probe_func</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">...</span>) <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">take_off_velocity</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_samozino_take_off_velocity.html">get_samozino_take_off_velocity</a></span>(<span class="no">...</span>)),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">100</span>),
  <span class="kw">bodyweight</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">gravity_const</span> <span class="kw">=</span> <span class="fl">9.81</span>
)


<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">take_off_velocity</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Take-off velocity"</span>) +
  <span class="fu">scale_color_manual</span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"F0"</span> <span class="kw">=</span> <span class="st">"#4D4D4D"</span>,
    <span class="st">"V0"</span> <span class="kw">=</span> <span class="st">"#5DA5DA"</span>
  )) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">1.6</span>)) +
  <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>) +
  <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="no">tov</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>)


<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.6</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>As can be seen from the above probing experiment, increasing <span class="math inline">\(V_0\)</span> in this profile creates higher improvements in take-off velocity, reaching the same conclusion as with optimal slope concept.</p>
</div>
<div id="bootstrapping-optimization-estimators" class="section level1">
<h1 class="hasAnchor">
<a href="#bootstrapping-optimization-estimators" class="anchor"></a>Bootstrapping optimization estimators</h1>
<p>Like we did in the previous <a href="https://mladenjovanovic.github.io/vjsim/articles/profiling-vjsim.html">vignette on profiling</a>, we can use bootstrap and <a href="https://mladenjovanovic.github.io/bmbstats-book/"><code>bmbstats</code></a><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> package to get estimates of uncertainty around optimization metrics (i.e. <span class="math inline">\(S_{FV}\%\)</span>, <span class="math inline">\(FV_{IMB}\)</span>, and <span class="math inline">\(probe_{IMB}\)</span>).</p>
<p><code>bmbstats</code> needs to be installed from the GitHub repository:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># Install bmbstats if you haven't already by running the following commands</span>
<span class="co"># install.packages("devtools")</span>
<span class="co"># devtools::install_github("mladenjovanovic/bmbstats")</span>

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">bmbstats</span>)</pre></body></html></div>
<p>The following code (actually a wrapper code), puts optimization estimators inside the bootstrap loop (1000 resamples) and provides 90% confidence intervals (CIs) estimated using the percentile method.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">boot_optimization</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">profile_data</span>) {
  <span class="no">optimization_estimators</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>, <span class="no">SESOI_lower</span>, <span class="no">SESOI_upper</span>, <span class="no">na.rm</span>, <span class="no">init_boot</span>) {

    <span class="co"># Get Samozino profile</span>
    <span class="no">samozino_profile</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>(
      <span class="kw">profile_data</span> <span class="kw">=</span> <span class="no">data</span>
    )

    <span class="co"># Return chosen optimization estimators</span>

    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
      <span class="kw">practical.Sfv_perc</span> <span class="kw">=</span> <span class="no">samozino_profile</span>$<span class="no">list</span>$<span class="no">samozino_practical_profile</span>$<span class="no">Sfv_perc</span>,
      <span class="kw">practical.FV_imbalance</span> <span class="kw">=</span> <span class="no">samozino_profile</span>$<span class="no">list</span>$<span class="no">samozino_practical_profile</span>$<span class="no">FV_imbalance</span>,
      <span class="kw">practical.probe_IMB</span> <span class="kw">=</span> <span class="no">samozino_profile</span>$<span class="no">list</span>$<span class="no">samozino_practical_profile</span>$<span class="no">probe_IMB</span>,

      <span class="kw">theoretical.Sfv_perc</span> <span class="kw">=</span> <span class="no">samozino_profile</span>$<span class="no">list</span>$<span class="no">samozino_theoretical_profile</span>$<span class="no">Sfv_perc</span>,
      <span class="kw">theoretical.FV_imbalance</span> <span class="kw">=</span> <span class="no">samozino_profile</span>$<span class="no">list</span>$<span class="no">samozino_theoretical_profile</span>$<span class="no">FV_imbalance</span>,
      <span class="kw">theoretical.probe_IMB</span> <span class="kw">=</span> <span class="no">samozino_profile</span>$<span class="no">list</span>$<span class="no">samozino_theoretical_profile</span>$<span class="no">probe_IMB</span>
    ))
  }

  <span class="co"># Perform bootstrap</span>
  <span class="no">boot_data</span> <span class="kw">&lt;-</span> <span class="kw pkg">bmbstats</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/bmbstats/man/bmbstats.html">bmbstats</a></span>(
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">profile_data</span>,
    <span class="kw">estimator_function</span> <span class="kw">=</span> <span class="no">optimization_estimators</span>,
    <span class="kw">boot_samples</span> <span class="kw">=</span> <span class="fl">1000</span>,
    <span class="kw">boot_type</span> <span class="kw">=</span> <span class="st">"perc"</span>,
    <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1667</span>
  )

  <span class="co"># Add plot</span>
  <span class="no">boot_data</span>$<span class="no">graphs</span> <span class="kw">&lt;-</span> <span class="kw pkg">bmbstats</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/bmbstats/man/plot_bootstrap_distribution.html">plot_bootstrap_distribution</a></span>(<span class="no">boot_data</span>$<span class="no">boot</span>)

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">boot_data</span>)
}

<span class="no">boot_data</span> <span class="kw">&lt;-</span> <span class="fu">boot_optimization</span>(<span class="no">profile_data</span>)

<span class="no">boot_data</span>$<span class="no">estimators</span>
<span class="co">#&gt;                  estimator       value       lower      upper</span>
<span class="co">#&gt; 1       practical.Sfv_perc 100.8027997  94.5438566 105.188440</span>
<span class="co">#&gt; 2   practical.FV_imbalance   0.8027997   0.1863488   6.347263</span>
<span class="co">#&gt; 3      practical.probe_IMB 101.2062250  94.6361827 105.782449</span>
<span class="co">#&gt; 4     theoretical.Sfv_perc 152.2394581 129.5177415 171.322756</span>
<span class="co">#&gt; 5 theoretical.FV_imbalance  52.2394581  29.5177415  71.322756</span>
<span class="co">#&gt; 6    theoretical.probe_IMB 155.0620464 131.1792063 175.012273</span></pre></body></html></div>
<p>From the 90% CIs above we can see some randomness involved in estimating optimization estimators. Using <code><a href="https://rdrr.io/pkg/bmbstats/man/plot_bootstrap_distribution.html">bmbstats::plot_bootstrap_distribution</a></code> we can plot the bootstrap distribution (I have created this object inside the above function):</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">boot_data</span>$<span class="no">graphs</span></pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>One of the main take-away points is the difference between theoretical and practical profiles (and their optimization estimators), as well as uncertainty involved when estimating them with 6 observations. And this is all without any <em>measurement error</em> involved.</p>
</div>
<div id="probing-force-generator-characteristics" class="section level1">
<h1 class="hasAnchor">
<a href="#probing-force-generator-characteristics" class="anchor"></a>Probing Force Generator characteristics</h1>
<p>What happens to Samozino profile estimators when we probe the Force Generator? Let’s find out, but let’s use more <em>force dominant profile</em>:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">3</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="no"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>
)

<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span>(<span class="no">probe_data</span>, <span class="kw">rownames</span> <span class="kw">=</span> <span class="fl">FALSE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html">formatRound</a></span>(<span class="kw">columns</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">probe_data</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<div id="htmlwidget-5959372c93acb2f2e50b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5959372c93acb2f2e50b">{"x":{"filter":"none","data":[[0.8,0.866666666666667,0.933333333333333,1,1.06666666666667,1.13333333333333,1.2,0.8,0.866666666666667,0.933333333333333,1,1.06666666666667,1.13333333333333,1.2,0.8,0.866666666666667,0.933333333333333,1,1.06666666666667,1.13333333333333,1.2,0.8,0.866666666666667,0.933333333333333,1,1.06666666666667,1.13333333333333,1.2,0.8,0.866666666666667,0.933333333333333,1,1.06666666666667,1.13333333333333,1.2],["mass","mass","mass","mass","mass","mass","mass","push_off_distance","push_off_distance","push_off_distance","push_off_distance","push_off_distance","push_off_distance","push_off_distance","max_force","max_force","max_force","max_force","max_force","max_force","max_force","max_velocity","max_velocity","max_velocity","max_velocity","max_velocity","max_velocity","max_velocity","time_to_max_activation","time_to_max_activation","time_to_max_activation","time_to_max_activation","time_to_max_activation","time_to_max_activation","time_to_max_activation"],[60,65,70,75,80,85,90,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75],[0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.32,0.346666666666667,0.373333333333333,0.4,0.426666666666667,0.453333333333333,0.48,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4,0.4],[3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,2800,3033.33333333333,3266.66666666667,3500,3733.33333333333,3966.66666666667,4200,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500,3500],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2.4,2.6,2.8,3,3.2,3.4,3.6,3,3,3,3,3,3,3],[0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.24,0.26,0.28,0.3,0.32,0.34,0.36],[0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001],[4295.53494196625,4216.69826569207,4137.96926415517,4064.0504917619,3986.60039134413,3922.15737072127,3858.97240926746,4413.07652923202,4287.81751230127,4174.54459800509,4064.0504917619,3954.19748114736,3856.28847168021,3757.00765153793,2939.72715240207,3302.43185808717,3674.57897245192,4064.0504917619,4457.91263618904,4857.08197152515,5273.75600249203,4015.32066972477,4035.04680363265,4049.06960095494,4064.0504917619,4070.67080365411,4073.55922494211,4076.47839165271,3817.59487397073,3895.64746168108,3978.81908162568,4064.0504917619,4151.81614591126,4244.27191656432,4344.9203244162],[71.5922490327708,64.8722810106473,59.1138466307882,54.1873398901586,49.8325048918016,46.1430278908385,42.8774712140829,58.8410203897603,57.1709001640169,55.6605946400679,54.1873398901586,52.7226330819648,51.4171796224029,50.0934353538391,39.1963620320276,44.0324247744956,48.9943862993589,54.1873398901586,59.4388351491872,64.7610929536687,70.3167466998938,53.5376089296637,53.8006240484353,53.9875946793992,54.1873398901586,54.2756107153882,54.3141229992281,54.3530452220361,50.9012649862764,51.9419661557478,53.0509210883424,54.1873398901586,55.3575486121501,56.5902922208575,57.932270992216],[1.55124989314545,1.56751745224942,1.58550161954347,1.60431350028854,1.62595510899389,1.64645240404843,1.66840371608089,1.4324725967658,1.49408076499284,1.5508405988864,1.60431350028854,1.65575388249614,1.7028800356459,1.7484444483403,1.73430306650283,1.6798638565025,1.63841269214163,1.60431350028854,1.57792576736479,1.55700808150723,1.53828538337898,1.40568071795893,1.47499499462333,1.54137052799143,1.60431350028854,1.66618805178211,1.72640968303326,1.78436680635381,1.75615788860189,1.7032223513742,1.65266407959513,1.60431350028854,1.55884271814934,1.51466864138169,1.47195504830756],[1665.86202993192,1652.43703058554,1640.18924248478,1630.00276744697,1620.50831845575,1614.41135802007,1609.58097696887,1580.4027988888,1601.58641723219,1618.51331111205,1630.00276744697,1636.79445789155,1641.69916252892,1642.22979267588,1274.59445377314,1386.90897924076,1505.11920668549,1630.00276744697,1758.56380432595,1890.62897055193,2028.13544353516,1411.06471046351,1487.91845960726,1560.2791371745,1630.00276744697,1695.62576394669,1758.15802258738,1818.48318222091,1676.07483835246,1658.78845745235,1643.91284385262,1630.00276744697,1618.00709153716,1607.16639437923,1598.88185150464],[27.7643671655321,25.4221081628545,23.4312748926397,21.7333702326263,20.2563539806969,18.9930748002361,17.8842330774318,21.0720373185173,21.3544855630959,21.580177481494,21.7333702326263,21.8239261052207,21.8893221670523,21.8963972356784,16.9945927169752,18.4921197232101,20.0682560891399,21.7333702326263,23.4475173910126,25.2083862740258,27.0418059138021,18.8141961395135,19.8389127947634,20.8037218289933,21.7333702326263,22.6083435192891,23.4421069678317,24.2464424296121,22.3476645113661,22.117179432698,21.9188379180349,21.7333702326263,21.5734278871621,21.4288852583897,21.3184246867285],[-2769.07992770671,-2690.04868790522,-2609.88018753753,-2533.20220208268,-2451.85144982937,-2382.18691355861,-2312.97279673547,-3080.74062931169,-2869.86996470825,-2691.79476021112,-2533.20220208268,-2388.15534298261,-2264.56849041484,-2148.77152951829,-1695.04812000935,-1965.89256046194,-2242.76764338827,-2533.20220208268,-2825.1725958148,-3119.4969565112,-3428.33394861217,-2856.49551738541,-2735.63423492368,-2626.92813144111,-2533.20220208268,-2443.10406577472,-2359.55536219245,-2284.55179570541,-2173.83351391599,-2287.22189944136,-2407.51834008542,-2533.20220208268,-2663.39643991813,-2802.11248890231,-2951.80231856397],[-46.1513321284452,-41.385364429311,-37.2840026791076,-33.7760293611023,-30.6481431228671,-28.0257283948071,-25.6996977415052,-41.0765417241559,-38.2649328627767,-35.8905968028149,-33.7760293611023,-31.8420712397681,-30.1942465388646,-28.6502870602438,-22.6006416001246,-26.2119008061592,-29.9035685785103,-33.7760293611023,-37.6689679441973,-41.5932927534827,-45.711119314829,-38.0866068984721,-36.4751231323157,-35.0257084192149,-33.7760293611023,-32.5747208769962,-31.460738162566,-30.4606906094054,-28.9844468522132,-30.4962919925514,-32.1002445344723,-33.7760293611023,-35.5119525322417,-37.3614998520308,-39.3573642475197],[2.37247538456508,2.33234558860628,2.29240207442608,2.25227314736147,2.21245450787204,2.17200549579728,2.13143965591156,2.06339339409307,2.13257673378479,2.195333789104,2.25227314736147,2.30445808130625,2.35187089054595,2.39498397892245,2.10864605048381,2.1644065627446,2.21174901467846,2.25227314736147,2.28766831652821,2.31905522840147,2.34627710628586,2.02662346384759,2.10762837890997,2.18257216423881,2.25227314736147,2.31777829170449,2.37932399741928,2.43713987064007,2.35644972235682,2.32134288265702,2.28683140913095,2.25227314736147,2.21866038901444,2.18479589866431,2.15139608180762],[0.286882744667034,0.277259732145319,0.267844407279969,0.258549150373371,0.249488019847264,0.24044892323005,0.231551223587787,0.217002665585469,0.231798344825699,0.245641714861454,0.258549150373371,0.270669064653298,0.281921339745025,0.292352102920246,0.226625288798214,0.238769407178996,0.249328934960813,0.258549150373371,0.266739364242966,0.274108927236299,0.280581868475084,0.209337546596209,0.226406594474345,0.242794151483694,0.258549150373371,0.273807146253649,0.288541421238291,0.302734492816692,0.283020147502321,0.274649988728971,0.266544235157382,0.258549150373371,0.250889598459822,0.243289149786972,0.235907497493231],[2366.4793635635,2454.09799237393,2540.4993212804,2626.7280848575,2712.07844339008,2798.89011580586,2885.76763232014,2729.07802960316,2694.48098249659,2660.80160676777,2626.7280848575,2592.55211018296,2560.05742038466,2527.18426063004,2352.30297512658,2440.42011715209,2531.76749362977,2626.7280848575,2722.86694039166,2819.97567499637,2919.3821967398,2459.20294884566,2518.56440688663,2573.90453023461,2626.7280848575,2676.00329675026,2722.56597139362,2767.12955781164,2661.3672092063,2648.39499486785,2637.20836248214,2626.7280848575,2617.67459977675,2609.48051352267,2603.210660516],[39.4413227260583,37.7553537288297,36.2928474468628,35.0230411314333,33.9009805423761,32.9281190094807,32.0640848035571,36.3877070613755,35.9264130999545,35.4773547569036,35.0230411314333,34.5673614691061,34.1340989384621,33.6957901417339,31.3640396683544,32.5389348953612,33.7568999150635,35.0230411314333,36.3048925385554,37.5996756666183,38.9250959565306,32.7893726512755,33.5808587584883,34.3187270697948,35.0230411314333,35.6800439566702,36.3008796185816,36.8950607708218,35.4848961227507,35.3119332649047,35.1627781664285,35.0230411314333,34.9023279970234,34.7930735136355,34.7094754735466],[2.81576430469849,2.69335134248178,2.58246751533574,2.48217967720919,2.39006113175712,2.30721649114153,2.23106109991922,2.31639078362095,2.37758058436654,2.43312136762899,2.48217967720919,2.52537945364738,2.56509740673277,2.59930360956974,2.16739844697012,2.273229874632,2.37797382338237,2.48217967720919,2.5834002804015,2.68176635325674,2.77885567131301,2.29515780489098,2.36312155534125,2.42476613852073,2.48217967720919,2.53456453660704,2.58308968974209,2.62869250496394,2.51911849301294,2.5053490293809,2.49341366763355,2.48217967720919,2.47243426157727,2.46358060319008,2.45678442510329],[0.404104426891845,0.369731981264744,0.339915326831916,0.314027328499643,0.291151489046757,0.271317420390118,0.253702026413732,0.273479422074379,0.288118738240569,0.301736970585031,0.314027328499643,0.325053066106292,0.335358041445505,0.344361837960281,0.239429967337619,0.263382977397833,0.288214052750722,0.314027328499643,0.340160907847117,0.366558130769849,0.393579949706077,0.268488747231743,0.28462505063839,0.299668237877839,0.314027328499643,0.327421889979349,0.340079108401832,0.352192879542256,0.323443333456561,0.319917102234063,0.316876223554857,0.314027328499643,0.311566319450558,0.30933890909035,0.307634553197642],[0.117221682224811,0.092472249119425,0.0720709195519471,0.0554781781262723,0.0416634691994928,0.0308684971600673,0.0221508028259449,0.0564767564889098,0.0563203934148691,0.0560952557235775,0.0554781781262723,0.0543840014529945,0.05343670170048,0.0520097350400349,0.012804678539405,0.0246135702188367,0.0388851177899099,0.0554781781262723,0.0734215436041502,0.0924492035335506,0.112998081230993,0.0591512006355339,0.058218456164045,0.0568740863941454,0.0554781781262723,0.0536147437257001,0.051537687163541,0.0494583867255639,0.0404231859542395,0.0452671135050927,0.0503319883974751,0.0554781781262723,0.0606767209907354,0.0660497593033776,0.0717270557044118],[1.40860485478436,1.33352210363876,1.26907755993058,1.21457497750875,1.16699587108431,1.12837860425989,1.09566264640164,1.26025835367753,1.24297150808915,1.22836209132971,1.21457497750875,1.2009243336421,1.18954472105166,1.1779010122401,1.05650154317423,1.10308510838822,1.15595910597389,1.21457497750875,1.27525574941864,1.33727177172108,1.40272766677733,1.28256374261245,1.25714116807954,1.23424817297531,1.21457497750875,1.19581206867418,1.17861451899129,1.16337215579697,1.14282794462153,1.16481745990444,1.18883165253136,1.21457497750875,1.24184629958046,1.27148666252158,1.30404737647844],[1665.86202993192,1652.43703058554,1640.18924248478,1630.00276744697,1620.50831845575,1614.41135802007,1609.58097696887,1580.4027988888,1601.58641723219,1618.51331111205,1630.00276744697,1636.79445789155,1641.69916252892,1642.22979267588,1274.59445377314,1386.90897924076,1505.11920668549,1630.00276744697,1758.56380432595,1890.62897055193,2028.13544353516,1411.06471046351,1487.91845960726,1560.2791371745,1630.00276744697,1695.62576394669,1758.15802258738,1818.48318222091,1676.07483835246,1658.78845745235,1643.91284385262,1630.00276744697,1618.00709153716,1607.16639437923,1598.88185150464],[27.7643671655321,25.4221081628545,23.4312748926397,21.7333702326263,20.2563539806969,18.9930748002361,17.8842330774318,21.0720373185173,21.3544855630959,21.580177481494,21.7333702326263,21.8239261052207,21.8893221670523,21.8963972356784,16.9945927169752,18.4921197232101,20.0682560891399,21.7333702326263,23.4475173910126,25.2083862740258,27.0418059138021,18.8141961395135,19.8389127947634,20.8037218289933,21.7333702326263,22.6083435192891,23.4421069678318,24.2464424296121,22.3476645113661,22.117179432698,21.9188379180349,21.7333702326263,21.5734278871621,21.4288852583897,21.3184246867285],[2.81576434660609,2.69335134589126,2.58246756270862,2.48217972458946,2.39006113208373,2.30721645886425,2.23106112830586,2.31639078333068,2.37758062834469,2.43312132103566,2.48217972458946,2.52537940852567,2.56509741981875,2.59930361073514,2.16739843110677,2.27322986443199,2.37797386759594,2.48217972458946,2.58340028101733,2.68176630706414,2.77885563015304,2.29515777686128,2.36312155707768,2.42476613865404,2.48217972458946,2.53456455459213,2.58308964359427,2.62869250704967,2.51911853679372,2.50534898683443,2.49341362516256,2.48217972458946,2.47243426355888,2.4635806048012,2.45678447034691],[0.443288962041009,0.361005757284986,0.290065488282539,0.22990657722799,0.17760662421169,0.135210963066974,0.0996214723943027,0.252997389237612,0.2450038945599,0.23778753193166,0.22990657722799,0.220921327219414,0.213226529272802,0.204319631812682,0.0587523806229622,0.108823301687387,0.166224852917475,0.22990657722799,0.295731964489125,0.362711078662675,0.432578523867177,0.268534313013682,0.255493178167709,0.242193974415228,0.22990657722799,0.216786262887644,0.203765646174983,0.191552636409596,0.162668814436896,0.184006104177413,0.206582216031612,0.22990657722799,0.253773874544438,0.278784706136892,0.305388388539288],[1.18684660120184,1.15478227542631,1.12653342601566,1.10207757327184,1.08027583101924,1.06225166710149,1.04673905363354,1.12261229000823,1.11488632070232,1.10831497839274,1.10207757327184,1.09586693245216,1.09066251473664,1.08531148166787,1.02786260909434,1.05027858608477,1.07515538689712,1.10207757327184,1.12927222113122,1.15640467472294,1.18436804532093,1.13250330799184,1.12122306793945,1.11096722407788,1.10207757327184,1.0935319239392,1.08564014249257,1.07859730937777,1.06903131133823,1.07926709386715,1.09033556877292,1.10207757327184,1.11438157718999,1.12760217387232,1.14194893777193],[-840.439435791805,-911.168904578418,-983.748800786023,-1058.23446585093,-1134.73183064411,-1213.1025096917,-1293.45074073705,-1178.15959591114,-1133.28692209794,-1093.57537283915,-1058.23446585093,-1026.59903502365,-998.035167656836,-972.254357407815,-1085.31173786478,-1073.54744207167,-1064.67424861248,-1058.23446585093,-1053.98569515076,-1051.5366752856,-1050.569925915,-1071.47445095283,-1065.77861015826,-1061.50629924454,-1058.23446585093,-1055.8039687293,-1053.9959112552,-1052.66384432043,-1056.46765588356,-1057.09622244622,-1057.66981095642,-1058.23446585093,-1058.74386245838,-1059.22270622835,-1059.60076672439],[-14.0073239298634,-14.0179831473603,-14.0535542969432,-14.1097928780124,-14.1841478830513,-14.271794231667,-14.3716748970784,-15.7087946121486,-15.1104922946393,-14.5810049711886,-14.1097928780124,-13.6879871336487,-13.3071355687578,-12.9633914321042,-14.4708231715304,-14.313965894289,-14.1956566481664,-14.1097928780124,-14.0531426020102,-14.020489003808,-14.0075990122,-14.2863260127043,-14.2103814687768,-14.1534173232605,-14.1097928780124,-14.0773862497241,-14.053278816736,-14.0355179242724,-14.0862354117808,-14.0946162992829,-14.1022641460856,-14.1097928780124,-14.1165848327784,-14.122969416378,-14.1280102229919],[329.480008883433,295.230519214202,265.299453016077,239.38005081376,216.073206339654,196.371443841463,178.821869584106,261.487547188305,253.234190631578,246.146248998152,239.38005081376,232.627857762168,226.902674755594,221.009195088336,156.180759948671,183.121162923948,210.65294349996,239.38005081376,268.046578697701,296.660785099478,326.33086708876,266.594832461495,256.679408729872,247.471742118786,239.38005081376,231.397507315214,223.867601097472,217.025768295505,205.764322439,216.368373178793,227.624757286811,239.38005081376,251.561924877069,264.544224026313,278.576838679445],[229.480008883433,195.230519214202,165.299453016077,139.38005081376,116.073206339654,96.3714438414627,78.8218695841058,161.487547188305,153.234190631578,146.146248998152,139.38005081376,132.627857762168,126.902674755594,121.009195088336,56.1807599486711,83.1211629239475,110.65294349996,139.38005081376,168.046578697701,196.660785099478,226.33086708876,166.594832461495,156.679408729872,147.471742118786,139.38005081376,131.397507315214,123.867601097472,117.025768295505,105.764322439,116.368373178793,127.624757286811,139.38005081376,151.561924877069,164.544224026313,178.576838679445],[341.635432826798,304.547649125395,272.68163038345,245.453929152992,221.236681914464,200.920674731039,182.925275186684,268.833865405249,260.092898491853,252.592413738797,245.453929152992,238.363339657545,232.36095543381,226.21335916845,159.726591637626,187.327509368682,215.659929190298,245.453929152992,275.501924208343,305.870305468048,337.764263232053,271.313737208156,262.115793829284,253.327837537306,245.453929152992,237.518751632916,229.915875875882,222.926659140182,210.929636612255,221.887044056388,233.453789616062,245.453929152992,257.804627978216,270.86792600095,284.885386767227],[3254.60162711585,3220.88152710896,3188.97016754589,3156.79903240908,3125.66501174528,3100.75629944622,3085.84068620276,3230.16399051109,3211.04550055083,3206.32661122894,3156.79903240908,3125.78445995548,3108.57131918678,3084.36610565126,2415.24907409104,2661.76015252657,2900.68731326717,3156.79903240908,3404.55245134622,3658.52044667322,3931.64442942983,3058.45188166797,3101.91312810554,3136.52146386853,3156.79903240908,3173.61167803166,3188.73823775863,3210.93061050327,3155.50394356093,3167.78358257944,3161.58124049792,3156.79903240908,3172.47506979321,3159.87321224402,3164.08910350204],[54.2433604519309,49.552023493984,45.556716679227,42.0906537654543,39.070812646816,36.4794858758379,34.2871187355863,43.0688532068145,42.8139400073443,42.7510214830526,42.0906537654543,41.6771261327397,41.4476175891571,41.1248814086835,32.2033209878805,35.490135367021,38.6758308435623,42.0906537654543,45.3940326846163,48.7802726223096,52.421925725731,40.7793584222395,41.3588417080739,41.8202861849137,42.0906537654543,42.3148223737555,42.5165098367817,42.8124081400436,42.0733859141457,42.2371144343925,42.1544165399723,42.0906537654543,42.2996675972428,42.1316428299202,42.1878547133605],[1.69967612027372,1.71874505767211,1.73520567139969,1.75595097506451,1.77249353578226,1.79345902459435,1.80360798829341,1.77630961817899,1.7668040615528,1.74662031440422,1.75595097506451,1.7473734808625,1.73984157392907,1.73388787358349,1.85392966643715,1.81189842819468,1.784311810974,1.75595097506451,1.73558252037321,1.71642782892216,1.69729645176949,1.34312741478623,1.47976730253751,1.61205795905847,1.75595097506451,1.89440817229169,2.02878117073537,2.15328600846534,1.76117713961831,1.74872106064477,1.75581385020502,1.75595097506451,1.74383607726713,1.74807917261325,1.74506860181766],[1382.9421666532,1383.96855151648,1383.37978016251,1385.79608476036,1385.05525708482,1390.2698420774,1391.41172805903,1434.44284116007,1418.32205805101,1400.05879844683,1385.79608476036,1365.47821805458,1352.10540416118,1336.98624707017,1119.42547757306,1205.70975914853,1293.93265825126,1385.79608476036,1477.22043106256,1569.89657683766,1668.29153492263,1026.9726422682,1147.5274055706,1264.06359739674,1385.79608476036,1503.02897463588,1617.31302379215,1728.51298943744,1389.35035234373,1384.89246660535,1387.78703265366,1385.79608476036,1383.06912023399,1380.92713760557,1380.38813696869],[23.0490361108867,21.2918238694844,19.7625682880359,18.4772811301381,17.3131907135603,16.3561157891459,15.460130311767,19.1259045488009,18.9109607740134,18.6674506459577,18.4772811301381,18.2063762407277,18.0280720554824,17.8264832942689,14.9256730343075,16.0761301219804,17.2524354433502,18.4772811301381,19.6962724141675,20.9319543578355,22.2438871323017,13.6929685635759,15.300365407608,16.8541812986232,18.4772811301381,20.0403863284784,21.564173650562,23.0468398591659,18.5246713645831,18.4652328880714,18.5038271020488,18.4772811301381,18.4409216031198,18.412361834741,18.4051751595826],[-1914.83635517085,-1873.97282263104,-1837.80529311752,-1797.77173579296,-1763.42815849302,-1728.92508662001,-1710.92649080725,-1818.46900869823,-1817.43158193146,-1835.73189020341,-1797.77173579296,-1788.84737246476,-1786.69791880344,-1778.87287444757,-1302.772763075,-1469.04490401191,-1625.66166710726,-1797.77173579296,-1961.61946284993,-2131.4735085428,-2316.41586555546,-2277.1122441535,-2096.216832732,-1945.66296220542,-1797.77173579296,-1675.25231597397,-1571.75070616552,-1491.17701869606,-1791.70162533725,-1811.48592183789,-1800.6357793161,-1797.77173579296,-1819.25073758366,-1807.62591405985,-1813.16029651003],[-31.9139392528474,-28.8303511174006,-26.2543613302503,-23.9702898105728,-22.0428519811627,-20.340295136706,-19.0102943423028,-24.2462534493097,-24.2324210924194,-24.4764252027122,-23.9702898105728,-23.8512982995301,-23.8226389173792,-23.7183049926343,-17.3703035076667,-19.5872653868254,-21.6754888947635,-23.9702898105728,-26.1549261713324,-28.4196467805707,-30.8855448740727,-30.3614965887134,-27.94955776976,-25.9421728294057,-23.9702898105728,-22.3366975463196,-20.9566760822069,-19.8823602492807,-23.8893550044966,-24.1531456245052,-24.008477057548,-23.9702898105728,-24.2566765011154,-24.1016788541313,-24.1754706201337],[2.35143616229635,2.29874128189874,2.24372798331316,2.19217956293979,2.13697335933053,2.08699523323218,2.03209459435721,2.14848586827152,2.1656493454596,2.17429417627217,2.19217956293979,2.19758903806983,2.20563368003182,2.21112668063293,2.00168167263318,2.07341888813159,2.13682136670498,2.19217956293979,2.24099125584689,2.28370963063368,2.32266842623068,1.77934418804959,1.92581758881686,2.05919140352161,2.19217956293979,2.31211328502817,2.42171995995077,2.52077786647938,2.196278411936,2.18910514997405,2.19343232548636,2.19217956293979,2.18622026069328,2.18630045545546,2.18490722632116],[0.281817126674565,0.269327802298954,0.256590992003188,0.244936352506161,0.232755103898493,0.221995367152592,0.210469339470735,0.235269700619898,0.239043684377655,0.240955920742664,0.244936352506161,0.24614666565977,0.247952086161605,0.249188644128786,0.204216591159814,0.219116507933784,0.232721995576297,0.244936352506161,0.255965433679013,0.265817006985168,0.27496374200861,0.161369303748514,0.189030243903996,0.216119736816377,0.244936352506161,0.272470328379396,0.298915778003261,0.323869574522546,0.245853153044654,0.244249814354889,0.245216379535602,0.244936352506161,0.243606474427411,0.243624346662831,0.243313944323671],[2160.52931467993,2254.80635410474,2346.55179852265,2439.55336287951,2529.23464717423,2622.92459260591,2712.83635487,2606.90023037644,2545.86001366405,2488.73302071737,2439.55336287951,2389.74544995477,2348.73583545825,2309.40375544492,2228.49013876707,2297.62802049575,2367.5665162266,2439.55336287951,2510.33752921907,2581.2197927508,2655.53002750516,2153.65855738486,2251.08515715305,2343.97516893021,2439.55336287951,2530.16457811429,2617.15028116266,2700.53896955834,2442.32116884207,2438.84942272369,2441.10391681122,2439.55336287951,2437.42882946372,2435.75954678424,2435.33946609618],[36.0088219113321,34.6893285246883,33.5221685503236,32.5273781717268,31.6154330896779,30.857936383599,30.1426261652222,34.7586697383526,33.9448001821873,33.1831069428982,32.5273781717268,31.8632726660636,31.31647780611,30.7920500725989,29.7132018502276,30.6350402732767,31.567553549688,32.5273781717268,33.4711670562543,34.416263903344,35.4070670334021,28.7154474317982,30.0144687620407,31.2530022524029,32.5273781717268,33.7355277081906,34.8953370821688,36.0071862607779,32.5642822512276,32.5179923029825,32.5480522241496,32.5273781717268,32.4990510595162,32.4767939571233,32.4711928812824],[2.56037658412069,2.45514396213591,2.35814914639168,2.27221278426907,2.19047332541054,2.12018270902123,2.05159699450534,2.20099384617099,2.22843683539337,2.25023541985756,2.27221278426907,2.28556262020362,2.30269472411294,2.31572542292431,2.00929850771947,2.09905127965558,2.18609724268869,2.27221278426907,2.35381961806882,2.43279798372323,2.51293190834671,1.90740103856616,2.03906529599596,2.15712796645992,2.27221278426907,2.3761758229278,2.47186878863321,2.56024891167577,2.2754588873378,2.271386586973,2.27403188057067,2.27221278426907,2.26971816122859,2.26775609181737,2.26726196686073],[0.334124795947878,0.30722383581357,0.283428512093935,0.26314735391241,0.244555215245891,0.22911185777756,0.214528558909622,0.246909994883328,0.253105541771707,0.258081532157661,0.26314735391241,0.266248543538932,0.270255000613148,0.273322331828444,0.2057737305317,0.224567594570462,0.243579065689457,0.26314735391241,0.282388726153359,0.301656769272031,0.321856615372304,0.185432151844304,0.211915768235699,0.237166207657578,0.26314735391241,0.287778355388475,0.311423806642276,0.334091462623933,0.263899747113119,0.26295601327538,0.263568855643474,0.26314735391241,0.262569851367694,0.262116087856964,0.262001884325638],[0.052307669273313,0.0378960335146162,0.0268375200907472,0.0182110014062498,0.0118001113473983,0.00711649062496794,0.0040592194388871,0.01164029426343,0.014061857394052,0.0171256114149974,0.0182110014062498,0.0201018778791624,0.0223029144515432,0.0241336876996585,0.00155713937188587,0.00545108663667845,0.0108570701131607,0.0182110014062498,0.0264232924743463,0.0358397622868626,0.0468928733636939,0.0240628480957896,0.022885524331703,0.021046470841201,0.0182110014062498,0.0153080270090791,0.0125080286390156,0.0102218881013875,0.0180465940684651,0.0187061989204911,0.0183524761078722,0.0182110014062498,0.0189633769402836,0.0184917411941332,0.0186879400019671],[1.18560855364094,1.14070598427322,1.10459260428914,1.07434993303328,1.05069754067582,1.03205693306237,1.01928651198837,1.04947638490107,1.05882547129685,1.0710736277499,1.07434993303328,1.08166626115077,1.08994848479318,1.09684906703528,1.00762494057433,1.02487757169955,1.04665253100067,1.07434993303328,1.10322992481665,1.13482870299891,1.17054202499988,1.14911663827521,1.12106805693657,1.09738338178286,1.07434993303328,1.05618236341597,1.04184465846055,1.031561742459,1.07340395616235,1.07658633833519,1.07484196668521,1.07434993303328,1.07784430600564,1.07590268151535,1.07680587339091],[1382.9421666532,1383.96855151648,1383.37978016251,1385.79608476036,1385.05525708482,1390.2698420774,1391.41172805903,1434.44284116007,1418.32205805101,1400.05879844683,1385.79608476036,1365.47821805458,1352.10540416118,1336.98624707017,1119.42547757306,1205.70975914853,1293.93265825126,1385.79608476036,1477.22043106256,1569.89657683766,1668.29153492263,1026.9726422682,1147.5274055706,1264.06359739674,1385.79608476036,1503.02897463588,1617.31302379215,1728.51298943744,1389.35035234373,1384.89246660535,1387.78703265366,1385.79608476036,1383.06912023399,1380.92713760557,1380.38813696869],[23.0490361108867,21.2918238694844,19.7625682880359,18.4772811301381,17.3131907135603,16.3561157891459,15.460130311767,19.1259045488009,18.9109607740135,18.6674506459577,18.4772811301381,18.2063762407277,18.0280720554824,17.8264832942689,14.9256730343075,16.0761301219804,17.2524354433501,18.4772811301381,19.6962724141675,20.9319543578355,22.2438871323018,13.6929685635759,15.300365407608,16.8541812986232,18.4772811301381,20.0403863284784,21.564173650562,23.0468398591659,18.5246713645831,18.4652328880714,18.5038271020488,18.4772811301381,18.4409216031198,18.412361834741,18.4051751595826],[2.56037663176678,2.45514391811605,2.35814914865091,2.27221281656483,2.1904733102972,2.12018269250452,2.05159701837539,2.20099388904443,2.22843683544337,2.25023546788626,2.27221281656483,2.28556260562555,2.30269475007652,2.31572540480819,2.00929853258095,2.09905126318355,2.18609726883942,2.27221281656483,2.3538196207715,2.43279793922908,2.51293191185209,1.9074010640621,2.03906531842028,2.15712795036402,2.27221281656483,2.37617577900329,2.47186874374864,2.56024891303201,2.27545886325361,2.27138657662296,2.27403187042859,2.27221281656483,2.26971815074783,2.26775608118546,2.26726199863823],[0.208940469470428,0.15640263621731,0.114421165337748,0.0800332536250474,0.053499950966668,0.0331874592723391,0.0195024240181723,0.0525080207729101,0.0627874899837773,0.0759412916140962,0.0800332536250474,0.0879735675557187,0.0970610700447043,0.10459872417527,0.00761685994777173,0.0256323750519631,0.0492759021344353,0.0800332536250474,0.112828364924611,0.149088308595401,0.190263485621405,0.128056876012514,0.11324772960342,0.0979365468424058,0.0800332536250474,0.0640624939751189,0.0501487837978627,0.0394710465526238,0.0791804513176086,0.0822814266489043,0.0805995449422303,0.0800332536250474,0.0834978900545518,0.0814556257300025,0.0823547723170694],[1.08885653492136,1.06803838146071,1.05099600583881,1.0365085301305,1.02503538508474,1.01590202926383,1.00959720284298,1.02443954672839,1.02899245444117,1.03492687072561,1.0365085301305,1.0400318558346,1.04400597928995,1.04730562255498,1.00380523039797,1.01236237173235,1.02306037505157,1.0365085301305,1.05034752573453,1.06528339093356,1.08191590477259,1.07196858082465,1.05880501365293,1.04756068167093,1.0365085301305,1.02770733354198,1.02070792024974,1.01565828035762,1.03605210108486,1.03758678592935,1.03674585443358,1.0365085301305,1.03819280772198,1.037257288003,1.03769257171424],[-843.832633089759,-918.400871345694,-995.082012566179,-1073.64652631521,-1154.6521100412,-1237.12196191656,-1322.30470318275,-1184.41959068246,-1142.44208012952,-1105.98784409629,-1073.64652631521,-1045.58301261589,-1019.99444861847,-997.270113539018,-1109.08863476755,-1094.60309177047,-1083.01061361512,-1073.64652631521,-1066.49528704271,-1061.00868630301,-1056.74571550658,-1129.10631473904,-1103.97894641894,-1086.61850635451,-1073.64652631521,-1064.80528658723,-1058.77394997563,-1054.79547603469,-1073.33126624823,-1073.72713949758,-1073.46952242315,-1073.64652631521,-1073.89052574895,-1074.08356461838,-1074.13236833332],[-14.0638772181627,-14.1292441745491,-14.215457322374,-14.3152870175362,-14.433151375515,-14.5543760225478,-14.6922744798083,-15.7922612090994,-15.2325610683936,-14.7465045879505,-14.3152870175362,-13.9411068348786,-13.5999259815796,-13.2969348471869,-14.7878484635674,-14.5947078902729,-14.4401415148683,-14.3152870175362,-14.2199371605695,-14.1467824840402,-14.089942873421,-15.0547508631873,-14.7197192855859,-14.4882467513935,-14.3152870175362,-14.1974038211631,-14.1169859996751,-14.0639396804625,-14.3110835499764,-14.3163618599677,-14.3129269656421,-14.3152870175362,-14.3185403433194,-14.3211141949117,-14.321764911111],[226.921344361799,204.047369846806,184.688826640336,167.445401417445,152.723763561139,139.753810848329,129.389730422126,153.532500053502,159.083039179143,165.981199522442,167.445401417445,171.086116633564,175.167415981864,178.374228837048,117.463358854817,134.207998776597,150.105792747567,167.445401417445,183.931376601702,200.891240199901,219.202768609762,201.673856077918,189.878334141394,179.05667452075,167.445401417445,157.32945141015,148.450073427071,141.371199685257,166.929044338757,168.710080541089,167.739813912136,167.445401417445,169.407466958969,168.294718735604,168.802314310984],[126.921344361799,104.047369846806,84.6888266403363,67.4454014174448,52.7237635611388,39.7538108483292,29.3897304221262,53.5325000535022,59.083039179143,65.9811995224422,67.4454014174448,71.0861166335645,75.1674159818642,78.3742288370477,17.463358854817,34.2079987765974,50.1057927475667,67.4454014174448,83.9313766017016,100.891240199901,119.202768609762,101.673856077918,89.878334141394,79.0566745207497,67.4454014174448,57.3294514101502,48.4500734270705,41.3711996852567,66.9290443387569,68.7100805410886,67.7398139121363,67.4454014174448,69.4074669589691,68.2947187356043,68.8023143109836],[232.999682119257,209.032561041586,188.949752085751,171.19350174747,156.113198169918,142.852556590282,132.291242937202,156.468404198832,162.364237670258,169.615835125832,171.19350174747,175.000936958398,179.21845016898,182.508871956564,119.997875737028,137.157396927286,153.414687031862,171.19350174747,188.167452062127,205.735419243103,224.840917511105,205.602465189703,194.101638844681,183.188001745844,171.19350174747,160.564195920703,151.133731508202,143.553969740907,170.656721490223,172.499713875842,171.495506149566,171.19350174747,173.220844330482,172.074814026973,172.59901190531]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>change_ratio<\/th>\n      <th>probing<\/th>\n      <th>mass<\/th>\n      <th>push_off_distance<\/th>\n      <th>max_force<\/th>\n      <th>max_velocity<\/th>\n      <th>time_to_max_activation<\/th>\n      <th>time_step<\/th>\n      <th>samozino_theoretical_profile.F0<\/th>\n      <th>samozino_theoretical_profile.F0_rel<\/th>\n      <th>samozino_theoretical_profile.V0<\/th>\n      <th>samozino_theoretical_profile.Pmax<\/th>\n      <th>samozino_theoretical_profile.Pmax_rel<\/th>\n      <th>samozino_theoretical_profile.Sfv<\/th>\n      <th>samozino_theoretical_profile.Sfv_rel<\/th>\n      <th>samozino_theoretical_profile.take_off_velocity<\/th>\n      <th>samozino_theoretical_profile.height<\/th>\n      <th>samozino_theoretical_profile.optimal_F0<\/th>\n      <th>samozino_theoretical_profile.optimal_F0_rel<\/th>\n      <th>samozino_theoretical_profile.optimal_V0<\/th>\n      <th>samozino_theoretical_profile.optimal_height<\/th>\n      <th>samozino_theoretical_profile.optimal_height_diff<\/th>\n      <th>samozino_theoretical_profile.optimal_height_ratio<\/th>\n      <th>samozino_theoretical_profile.optimal_Pmax<\/th>\n      <th>samozino_theoretical_profile.optimal_Pmax_rel<\/th>\n      <th>samozino_theoretical_profile.optimal_take_off_velocity<\/th>\n      <th>samozino_theoretical_profile.optimal_take_off_velocity_diff<\/th>\n      <th>samozino_theoretical_profile.optimal_take_off_velocity_ratio<\/th>\n      <th>samozino_theoretical_profile.optimal_Sfv<\/th>\n      <th>samozino_theoretical_profile.optimal_Sfv_rel<\/th>\n      <th>samozino_theoretical_profile.Sfv_perc<\/th>\n      <th>samozino_theoretical_profile.FV_imbalance<\/th>\n      <th>samozino_theoretical_profile.probe_IMB<\/th>\n      <th>samozino_practical_profile.F0<\/th>\n      <th>samozino_practical_profile.F0_rel<\/th>\n      <th>samozino_practical_profile.V0<\/th>\n      <th>samozino_practical_profile.Pmax<\/th>\n      <th>samozino_practical_profile.Pmax_rel<\/th>\n      <th>samozino_practical_profile.Sfv<\/th>\n      <th>samozino_practical_profile.Sfv_rel<\/th>\n      <th>samozino_practical_profile.take_off_velocity<\/th>\n      <th>samozino_practical_profile.height<\/th>\n      <th>samozino_practical_profile.optimal_F0<\/th>\n      <th>samozino_practical_profile.optimal_F0_rel<\/th>\n      <th>samozino_practical_profile.optimal_V0<\/th>\n      <th>samozino_practical_profile.optimal_height<\/th>\n      <th>samozino_practical_profile.optimal_height_diff<\/th>\n      <th>samozino_practical_profile.optimal_height_ratio<\/th>\n      <th>samozino_practical_profile.optimal_Pmax<\/th>\n      <th>samozino_practical_profile.optimal_Pmax_rel<\/th>\n      <th>samozino_practical_profile.optimal_take_off_velocity<\/th>\n      <th>samozino_practical_profile.optimal_take_off_velocity_diff<\/th>\n      <th>samozino_practical_profile.optimal_take_off_velocity_ratio<\/th>\n      <th>samozino_practical_profile.optimal_Sfv<\/th>\n      <th>samozino_practical_profile.optimal_Sfv_rel<\/th>\n      <th>samozino_practical_profile.Sfv_perc<\/th>\n      <th>samozino_practical_profile.FV_imbalance<\/th>\n      <th>samozino_practical_profile.probe_IMB<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],"render":"function(data, type, row, meta) { return DTWidget.formatRound(data, 2, 3, \",\", \".\"); }"},{"className":"dt-right","targets":[0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script><p>We can also plot the result of probing. I will split them in two figures of the most interesting estimators.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># Convert to long</span>
<span class="no">probe_data_1</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">8</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">variable</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.F0"</span>,
    <span class="st">"samozino_practical_profile.V0"</span>,
    <span class="st">"samozino_practical_profile.optimal_F0"</span>,
    <span class="st">"samozino_practical_profile.optimal_V0"</span>,
    <span class="st">"samozino_practical_profile.Pmax"</span>,

    <span class="st">"samozino_theoretical_profile.F0"</span>,
    <span class="st">"samozino_theoretical_profile.V0"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_F0"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_V0"</span>,
    <span class="st">"samozino_theoretical_profile.Pmax"</span>
  )) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">variable</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">variable</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.F0"</span>,
    <span class="st">"samozino_practical_profile.V0"</span>,
    <span class="st">"samozino_practical_profile.optimal_F0"</span>,
    <span class="st">"samozino_practical_profile.optimal_V0"</span>,
    <span class="st">"samozino_practical_profile.Pmax"</span>,

    <span class="st">"samozino_theoretical_profile.F0"</span>,
    <span class="st">"samozino_theoretical_profile.V0"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_F0"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_V0"</span>,
    <span class="st">"samozino_theoretical_profile.Pmax"</span>
  )))

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data_1</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(~<span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free_y"</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu">scale_color_manual</span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"mass"</span> <span class="kw">=</span> <span class="st">"#4D4D4D"</span>,
    <span class="st">"max_force"</span> <span class="kw">=</span> <span class="st">"#5DA5DA"</span>,
    <span class="st">"max_velocity"</span> <span class="kw">=</span>  <span class="st">"#FAA43A"</span>,
    <span class="st">"push_off_distance"</span> <span class="kw">=</span> <span class="st">"#60BD68"</span>,
    <span class="st">"time_to_max_activation"</span> <span class="kw">=</span> <span class="st">"#B276B2"</span>
  )) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.35</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-23-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The above figure depicts effects of probing Force Generator characteristics on selected profile estimators. Let’s see what happens to selected optimization parameters including predicted jump height:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co"># Convert to long</span>
<span class="no">probe_data_2</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">8</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">variable</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_practical_profile.optimal_height"</span>,
    <span class="st">"samozino_practical_profile.height"</span>,

    <span class="st">"samozino_theoretical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_height"</span>,
    <span class="st">"samozino_theoretical_profile.height"</span>
  )) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">variable</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">variable</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_practical_profile.optimal_height"</span>,
    <span class="st">"samozino_practical_profile.height"</span>,

    <span class="st">"samozino_theoretical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_height"</span>,
    <span class="st">"samozino_theoretical_profile.height"</span>
  )))

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data_2</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(~<span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free_y"</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu">scale_color_manual</span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"mass"</span> <span class="kw">=</span> <span class="st">"#4D4D4D"</span>,
    <span class="st">"max_force"</span> <span class="kw">=</span> <span class="st">"#5DA5DA"</span>,
    <span class="st">"max_velocity"</span> <span class="kw">=</span>  <span class="st">"#FAA43A"</span>,
    <span class="st">"push_off_distance"</span> <span class="kw">=</span> <span class="st">"#60BD68"</span>,
    <span class="st">"time_to_max_activation"</span> <span class="kw">=</span> <span class="st">"#B276B2"</span>
  )) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.35</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>What is interesting from the above figure, is that both practical and theoretical <span class="math inline">\(S_{FV}\%\)</span> showed predictable behavior when increasing Force Generator max force and max velocity. In other words, increasing max force increases <span class="math inline">\(S_{FV}\%\)</span> and decreasing max force decreases <span class="math inline">\(S_{FV}\%\)</span>. When it comes to max velocity, increasing it decreases <span class="math inline">\(S_{FV}\%\)</span> and decreasing max velocity increases <span class="math inline">\(S_{FV}\%\)</span>.</p>
<p>Let’s perform this same analysis, but now using more <em>velocity dominant profile</em>:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">probe_data_velocity</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">2500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">8</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="no"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>
)</pre></body></html></div>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="co"># Convert to long</span>
<span class="no">probe_data_1</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data_velocity</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">8</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">variable</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.F0"</span>,
    <span class="st">"samozino_practical_profile.V0"</span>,
    <span class="st">"samozino_practical_profile.optimal_F0"</span>,
    <span class="st">"samozino_practical_profile.optimal_V0"</span>,
    <span class="st">"samozino_practical_profile.Pmax"</span>,

    <span class="st">"samozino_theoretical_profile.F0"</span>,
    <span class="st">"samozino_theoretical_profile.V0"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_F0"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_V0"</span>,
    <span class="st">"samozino_theoretical_profile.Pmax"</span>
  )) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">variable</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">variable</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.F0"</span>,
    <span class="st">"samozino_practical_profile.V0"</span>,
    <span class="st">"samozino_practical_profile.optimal_F0"</span>,
    <span class="st">"samozino_practical_profile.optimal_V0"</span>,
    <span class="st">"samozino_practical_profile.Pmax"</span>,

    <span class="st">"samozino_theoretical_profile.F0"</span>,
    <span class="st">"samozino_theoretical_profile.V0"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_F0"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_V0"</span>,
    <span class="st">"samozino_theoretical_profile.Pmax"</span>
  )))

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data_1</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(~<span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free_y"</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu">scale_color_manual</span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"mass"</span> <span class="kw">=</span> <span class="st">"#4D4D4D"</span>,
    <span class="st">"max_force"</span> <span class="kw">=</span> <span class="st">"#5DA5DA"</span>,
    <span class="st">"max_velocity"</span> <span class="kw">=</span>  <span class="st">"#FAA43A"</span>,
    <span class="st">"push_off_distance"</span> <span class="kw">=</span> <span class="st">"#60BD68"</span>,
    <span class="st">"time_to_max_activation"</span> <span class="kw">=</span> <span class="st">"#B276B2"</span>
  )) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.35</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-26-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># Convert to long</span>
<span class="no">probe_data_2</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data_velocity</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">8</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">variable</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_practical_profile.optimal_height"</span>,
    <span class="st">"samozino_practical_profile.height"</span>,

    <span class="st">"samozino_theoretical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_height"</span>,
    <span class="st">"samozino_theoretical_profile.height"</span>
  )) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">variable</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">variable</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_practical_profile.optimal_height"</span>,
    <span class="st">"samozino_practical_profile.height"</span>,

    <span class="st">"samozino_theoretical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_height"</span>,
    <span class="st">"samozino_theoretical_profile.height"</span>
  )))

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data_2</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(~<span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free_y"</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu">scale_color_manual</span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"mass"</span> <span class="kw">=</span> <span class="st">"#4D4D4D"</span>,
    <span class="st">"max_force"</span> <span class="kw">=</span> <span class="st">"#5DA5DA"</span>,
    <span class="st">"max_velocity"</span> <span class="kw">=</span>  <span class="st">"#FAA43A"</span>,
    <span class="st">"push_off_distance"</span> <span class="kw">=</span> <span class="st">"#60BD68"</span>,
    <span class="st">"time_to_max_activation"</span> <span class="kw">=</span> <span class="st">"#B276B2"</span>
  )) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.35</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Both theoretical and practical profiles (using predicted height) showed higher improvements in predicted jump height when max force improves. I will further explore these topics in the next vignette (and at the end of this one), but so far, this model seems to predict intervention effects of increasing either max force or max velocity based on <span class="math inline">\(S_{FV}\%\)</span> metric.</p>
</div>
<div id="alternatives" class="section level1">
<h1 class="hasAnchor">
<a href="#alternatives" class="anchor"></a>Alternatives?</h1>
<p>The goal of optimization profile is to help answer intervention question: “What should athlete do?”. This is a complex question, but for the sake of this vignette, we are answering it from the vertical jump perspective: “What should athlete do to yield biggest effect in jump performance?”. In other way, should athlete focus on high-load and low-velocity activities (e.g. heavy squatting, or deadlifting), or low-load and high-velocity activities (e.g. unloaded jumping or even <em>assisted</em> jumping). Samozino optimization profile seems to help in answering this question. But let’s explore another approach and see if it works.</p>
<p>In the previous vignette I have demonstrated multitude of profiles that we can make. The simplest profile is Load~TOV, or mass and take-off velocity. This is actually THE profile we get from jumping, from which the Samozino profile is further developed using assumptions of constants acceleration and equal mean force over distance and time. Figure below depicts Load~TOV profile, termed <em>simple profile</em> which is estimated using <code><a href="../reference/get_simple_profile.html">vjsim::get_simple_profile</a></code> function.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">simple_profile</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_simple_profile.html">get_simple_profile</a></span>(<span class="no">profile_data</span>)

<span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">simple_profile</span>$<span class="no">L0</span>, <span class="fl">0</span>),
  <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="no">simple_profile</span>$<span class="no">TOV0</span>)
)

<span class="no">plot_data_points</span> <span class="kw">&lt;-</span> <span class="no">profile_data</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">mass</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">take_off_velocity</span>)

<span class="fu">ggplot</span>(<span class="no">plot_data</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="no">profile_data</span>$<span class="no">bodyweight</span>[<span class="fl">1</span>], <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>) +
  <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">take_off_velocity</span>[<span class="fl">1</span>], <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>) +
  <span class="fu">geom_line</span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
  <span class="fu">geom_point</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">plot_data_points</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Load (kg)"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Take-off Velocity (m/s)"</span>)</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-28-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Vertical dashed line indicates bodyweight (75kg in this case), and horizontal dashed line indicates predicted take-off velocity. As can be seen it is very close to <em>true</em> take-off velocity during the bodyweight jump.</p>
<p>Similar to Samozino model, we can check how changing slope of the profile affects the predicted vertical jump height. The logic is same as with Samozino profile, but simpler: we check where the profile line cuts the vertical dashed line:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>)

<span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu">tibble</span>(
  <span class="kw">k</span> <span class="kw">=</span> <span class="no">k</span>,
  <span class="kw">L0</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">L0</span> * <span class="no">k</span>,
  <span class="kw">TOV0</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">TOV0</span> / <span class="no">k</span>,
  <span class="kw">slope</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_slope.html">get_slope</a></span>(<span class="no">L0</span>, <span class="no">TOV0</span>),
  <span class="kw">predicted_TOV</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_simple_take_off_velocity.html">get_simple_take_off_velocity</a></span>(<span class="no">L0</span>, <span class="no">TOV0</span>, <span class="fl">75</span>),
  <span class="kw">group</span> <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">x</span> <span class="kw">=</span> <span class="no">L0</span>,
  <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0</span>,
)

<span class="no">plot_data_2</span> <span class="kw">&lt;-</span> <span class="no">plot_data</span>
<span class="no">plot_data_2</span>$<span class="no">group</span> <span class="kw">&lt;-</span> <span class="fl">2</span>
<span class="no">plot_data_2</span>$<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">plot_data_2</span>$<span class="no">y</span> <span class="kw">&lt;-</span> <span class="no">plot_data_2</span>$<span class="no">TOV0</span>

<span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="no">plot_data</span>,
  <span class="no">plot_data_2</span>
)

<span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="no">plot_data</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(
    <span class="kw">k</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">k</span>),
    <span class="kw">slope</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">slope</span>, <span class="fl">2</span>)
  )

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">plot_data</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">k</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">slope</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"blue"</span>) +
  <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="no">profile_data</span>$<span class="no">bodyweight</span>[<span class="fl">1</span>], <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Mean GRF over distance (N)"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Mean Velocity (m/s)"</span>) +
  <span class="fu">scale_color_gradient</span>(<span class="kw">low</span> <span class="kw">=</span> <span class="st">"black"</span>, <span class="kw">high</span> <span class="kw">=</span> <span class="st">"black"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.points"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.5</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-29-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The results of this search can be represented with the following figure:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">plot_data</span> <span class="kw">&lt;-</span> <span class="fu">tibble</span>(
  <span class="kw">k</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.3</span>, <span class="fl">2.5</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">100</span>),
  <span class="kw">L0</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">L0</span> * <span class="no">k</span>,
  <span class="kw">TOV0</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">TOV0</span> / <span class="no">k</span>,
  <span class="kw">slope</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_slope.html">get_slope</a></span>(<span class="no">L0</span>, <span class="no">TOV0</span>),
  <span class="kw">predicted_TOV</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_simple_take_off_velocity.html">get_simple_take_off_velocity</a></span>(<span class="no">L0</span>, <span class="no">TOV0</span>, <span class="fl">75</span>)
)

<span class="fu">ggplot</span>(<span class="no">plot_data</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">slope</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">predicted_TOV</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">Sfv</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>) +
  <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">optimal_Sfv</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>)</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-30-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Vertical dashed line represents optimal slope estimated using <code><a href="../reference/get_simple_profile.html">vjsim::get_simple_profile</a></code> function. Here is the output of the same function:</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">simple_profile</span>
<span class="co">#&gt; $L0</span>
<span class="co">#&gt; [1] 265.1471</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TOV0</span>
<span class="co">#&gt; [1] 3.471573</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Sfv</span>
<span class="co">#&gt; [1] -76.37664</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Sfv_rel</span>
<span class="co">#&gt; [1] -1.018355</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $take_off_velocity</span>
<span class="co">#&gt; [1] 2.489597</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $height</span>
<span class="co">#&gt; [1] 0.3159069</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_L0</span>
<span class="co">#&gt; [1] 150</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_TOV0</span>
<span class="co">#&gt; [1] 6.136516</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_Sfv</span>
<span class="co">#&gt; [1] -24.44384</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_Sfv_rel</span>
<span class="co">#&gt; [1] -0.3259178</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_take_off_velocity</span>
<span class="co">#&gt; [1] 3.068258</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $optimal_height</span>
<span class="co">#&gt; [1] 0.479827</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Sfv_perc</span>
<span class="co">#&gt; [1] 312.4576</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FV_imbalance</span>
<span class="co">#&gt; [1] 212.4576</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $probe_IMB</span>
<span class="co">#&gt; [1] 278.8824</span></pre></body></html></div>
<p>Using <code><a href="../reference/probe_simple_take_off_velocity.html">vjsim::probe_simple_take_off_velocity</a></code> we can further probe the behavior of the predicted take-off velocity when, in this case <span class="math inline">\(L_0\)</span> and <span class="math inline">\(TOV_0\)</span> change.</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">simple_probe_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/probe_simple_take_off_velocity.html">probe_simple_take_off_velocity</a></span>(
  <span class="kw">L0</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">L0</span>,
  <span class="kw">TOV0</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">TOV0</span>,
  <span class="kw">bodyweight</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">1001</span>)
)

<span class="fu">ggplot</span>(
  <span class="no">simple_probe_data</span>,
  <span class="fu">aes</span>(
    <span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>,
    <span class="kw">y</span> <span class="kw">=</span> <span class="no">take_off_velocity</span>,
    <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>
  )
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>) +
  <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="no">simple_profile</span>$<span class="no">take_off_velocity</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"grey"</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="st">"dashed"</span>)</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-32-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Let’s probe this model when the Force Generator characteristics change. We can use the“force-dominant” and “velocity-dominant” profiles and compare it to Samozino model behavior</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">probe_data_velocity</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">2500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">8</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">...</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">list</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_simple_profile.html">get_simple_profile</a></span>(<span class="no">...</span>))
  }
)


<span class="no">probe_data_force</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">3</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">...</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">list</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/get_simple_profile.html">get_simple_profile</a></span>(<span class="no">...</span>))
  }
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Velocity dominant"</span>, <span class="no">probe_data_velocity</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Force dominant"</span>, <span class="no">probe_data_force</span>)
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">variable</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L0"</span>, <span class="st">"TOV0"</span>, <span class="st">"height"</span>, <span class="st">"optimal_Sfv"</span>, <span class="st">"Sfv_perc"</span>, <span class="st">"probe_IMB"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">variable</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">variable</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L0"</span>, <span class="st">"TOV0"</span>, <span class="st">"height"</span>, <span class="st">"optimal_Sfv"</span>, <span class="st">"Sfv_perc"</span>, <span class="st">"probe_IMB"</span>)))


<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(<span class="no">profile</span> ~ <span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">6</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.4</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-33-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>As can be seen from the above graph, this simple model is not able to “predict” effects of increasing max force or max velocity of the force generator. If we check the height (actually predicted height), we can see that in velocity dominant profile, increasing max force parameter yields biggest effects. In the force dominant profile, increasing max velocity parameter of the Force generator yields biggest effect. This is not picked up with <span class="math inline">\(S_{FV}\%\)</span> nor <span class="math inline">\(probe_{IMB}\)</span>.</p>
<p>Let’s repeat the same visual (one more time) using practical Samozino method (which also uses take-off velocity):</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">probe_data_velocity</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">2500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">8</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="no"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>
)


<span class="no">probe_data_force</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">3</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="no"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Velocity dominant"</span>, <span class="no">probe_data_velocity</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Force dominant"</span>, <span class="no">probe_data_force</span>)
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">variable</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_practical_profile.F0"</span>,
    <span class="st">"samozino_practical_profile.V0"</span>,
    <span class="st">"samozino_practical_profile.height"</span>,
    <span class="st">"samozino_practical_profile.optimal_Sfv"</span>,
    <span class="st">"samozino_practical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_practical_profile.probe_IMB"</span>
  )) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">variable</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(
    <span class="no">variable</span>,
    <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
      <span class="st">"samozino_practical_profile.F0"</span>,
      <span class="st">"samozino_practical_profile.V0"</span>,
      <span class="st">"samozino_practical_profile.height"</span>,
      <span class="st">"samozino_practical_profile.optimal_Sfv"</span>,
      <span class="st">"samozino_practical_profile.Sfv_perc"</span>,
      <span class="st">"samozino_practical_profile.probe_IMB"</span>
    ),
    <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F0"</span>, <span class="st">"V0"</span>, <span class="st">"height"</span>, <span class="st">"optimal_Sfv"</span>, <span class="st">"Sfv_perc"</span>, <span class="st">"probe_IMB"</span>)
  ))


<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(<span class="no">profile</span> ~ <span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">6</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.4</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-34-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>And finally using theoretical Samozino model:</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="no">probe_data_velocity</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">2500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">8</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="no"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>
)


<span class="no">probe_data_force</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">3</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="no"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Velocity dominant"</span>, <span class="no">probe_data_velocity</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Force dominant"</span>, <span class="no">probe_data_force</span>)
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">variable</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
    <span class="st">"samozino_theoretical_profile.F0"</span>,
    <span class="st">"samozino_theoretical_profile.V0"</span>,
    <span class="st">"samozino_theoretical_profile.height"</span>,
    <span class="st">"samozino_theoretical_profile.optimal_Sfv"</span>,
    <span class="st">"samozino_theoretical_profile.Sfv_perc"</span>,
    <span class="st">"samozino_theoretical_profile.probe_IMB"</span>
  )) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">variable</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(
    <span class="no">variable</span>,
    <span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
      <span class="st">"samozino_theoretical_profile.F0"</span>,
      <span class="st">"samozino_theoretical_profile.V0"</span>,
      <span class="st">"samozino_theoretical_profile.height"</span>,
      <span class="st">"samozino_theoretical_profile.optimal_Sfv"</span>,
      <span class="st">"samozino_theoretical_profile.Sfv_perc"</span>,
      <span class="st">"samozino_theoretical_profile.probe_IMB"</span>
    ),
    <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"F0"</span>, <span class="st">"V0"</span>, <span class="st">"height"</span>, <span class="st">"optimal_Sfv"</span>, <span class="st">"Sfv_perc"</span>, <span class="st">"probe_IMB"</span>)
  ))


<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(<span class="no">profile</span> ~ <span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">6</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.4</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-35-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Both Samozino profiles (practical and theoretical) correctly identified the effects of increasing Force Generator max force or max velocity characteristics for two different profiles.</p>
<div id="loadpeak-force-profile" class="section level2">
<h2 class="hasAnchor">
<a href="#loadpeak-force-profile" class="anchor"></a>Load~Peak Force profile?</h2>
<p>Another profile that is commonly used in practice is the Load~Peak Force profile (LPF). This profile is useful once someone has force platform, but this also makes it less practical compared to Samozino model/profile (one just needs to calculate push-off distance and use jump height which can be estimated with a simple jump mat).</p>
<p>In the example below, I will provide LPF profile for velocity-dominant and force-dominant examples:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">profile_data_velocity</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/vj_profile.html">vj_profile</a></span>(
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),

  <span class="co"># Simulation parameters</span>
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">2500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">8</span>
)

<span class="no">profile_data_force</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/vj_profile.html">vj_profile</a></span>(
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),

  <span class="co"># Simulation parameters</span>
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">3</span>
)

<span class="no">merged_profiles</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Velocity dominant"</span>, <span class="no">profile_data_velocity</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Force dominant"</span>, <span class="no">profile_data_force</span>)
)

<span class="no">plot_merged_profiles</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">merged_profile_data</span>, <span class="no">x_var</span>, <span class="no">y_var</span>, <span class="no">profile</span> <span class="kw">=</span> <span class="st">"profile"</span>) {
  <span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
    <span class="kw">x_var</span> <span class="kw">=</span> <span class="no">merged_profile_data</span><span class="kw">[[</span><span class="no">x_var</span>]],
    <span class="kw">y_var</span> <span class="kw">=</span> <span class="no">merged_profile_data</span><span class="kw">[[</span><span class="no">y_var</span>]],
    <span class="kw">profile</span> <span class="kw">=</span> <span class="no">merged_profile_data</span><span class="kw">[[</span><span class="no">profile</span>]]
  )

  <span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(<span class="no">df</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x_var</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y_var</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">profile</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">profile</span>)) +
    <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">8</span>) +
    <span class="fu">geom_line</span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
    <span class="fu">geom_point</span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.8</span>) +
    <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x_var</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y_var</span>)

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">gg</span>)
}

<span class="fu">plot_merged_profiles</span>(<span class="no">merged_profiles</span>, <span class="st">"mass"</span>, <span class="st">"peak_GRF"</span>)</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-36-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>What can be noticed from this profile is that the more “force-dominant” athlete has more steep profile, while “velocity-dominant” athlete has more horizontal profile. We can say that “velocity-dominant” athlete is able to <em>squeeze</em> out ability to generate maximal force at lower loads (mass), and can thus benefit from developing max force capabilities (whatever they are in <em>ontological</em> sense). The “force-dominant” athlete, on the other hand, is unable to manifest maximal forces at lighter loads and would benefit from training that allows him to do that.</p>
<p>This LPF profile can be summarized with a slope metric:</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="no">LPF_velocity</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">peak_GRF</span> ~ <span class="no">mass</span>, <span class="no">profile_data_velocity</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">LPF_velocity</span>)<span class="kw">[[</span><span class="fl">2</span>]]
<span class="co">#&gt; [1] 2.674102</span></pre></body></html></div>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">LPF_force</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">peak_GRF</span> ~ <span class="no">mass</span>, <span class="no">profile_data_force</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">LPF_force</span>)<span class="kw">[[</span><span class="fl">2</span>]]
<span class="co">#&gt; [1] 9.277718</span></pre></body></html></div>
<p>Let’s check how this slope metric behaves when probed in for both profiles (and compare it to Samozino’s practical <span class="math inline">\(probe_{IMB}\)</span>):</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">LPF_profile</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">profile_data</span>) {
  <span class="no">LPF_profile_model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">peak_GRF</span> ~ <span class="no">mass</span>, <span class="no">profile_data</span>)
  <span class="no">samozino_profile</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_all_samozino_profiles.html">get_all_samozino_profiles</a></span>(<span class="no">profile_data</span>)

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">slope</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">LPF_profile_model</span>)<span class="kw">[[</span><span class="fl">2</span>]],
    <span class="kw">probe_IMB</span> <span class="kw">=</span> <span class="no">samozino_profile</span>$<span class="no">list</span>$<span class="no">samozino_practical_profile</span>$<span class="no">probe_IMB</span>
  )))
}

<span class="no">probe_data_velocity</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">2500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">8</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="no">LPF_profile</span>
)


<span class="no">probe_data_force</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3500</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">3</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.3</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="no">LPF_profile</span>
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Velocity dominant"</span>, <span class="no">probe_data_velocity</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Force dominant"</span>, <span class="no">probe_data_force</span>)
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">9</span>))

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(<span class="no">profile</span> ~ <span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">6</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.4</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-39-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>As can be seen from the figure above, increasing max force always increase <span class="math inline">\(probe_{IMB}\)</span>, while increasing max velocity always decrease <span class="math inline">\(probe_{IMB}\)</span>. We can also conclude that <span class="math inline">\(probe_{IMB}\)</span> is below 100 for velocity dominant profile and over 100 for force dominant profile. When it comes to LPF slope, the situation is similar to <span class="math inline">\(probe_{IMB}\)</span>.</p>
<p>Let’s explore this little further using two different profiles: explosive profile and slow profile:</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">profile_data_explosive</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/vj_profile.html">vj_profile</a></span>(
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),

  <span class="co"># Simulation parameters</span>
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3000</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">4</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.1</span>
)

<span class="no">profile_data_slow</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/vj_profile.html">vj_profile</a></span>(
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),

  <span class="co"># Simulation parameters</span>
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">push_off_distance</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3000</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">4</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.5</span>
)

<span class="no">merged_profiles</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Explosive profile"</span>, <span class="no">profile_data_explosive</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Slow profile"</span>, <span class="no">profile_data_slow</span>)
)

<span class="fu">plot_merged_profiles</span>(<span class="no">merged_profiles</span>, <span class="st">"mass"</span>, <span class="st">"peak_GRF"</span>)</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-40-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>From the figure above, the explosive profile has more horizontal slope, while slow profile has steeper slope. When it comes to mean GRF-TOV profile (the basis behind Samozino profile), we get the following:</p>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu">plot_merged_profiles</span>(<span class="no">merged_profiles</span>, <span class="st">"mean_GRF_over_distance"</span>, <span class="st">"take_off_velocity"</span>)</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-41-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>This profile is not much affected. It seems that LPF slope reflects the time to max activation and max force characteristics of the Force Generator.</p>
<p>When we probe LPF slope and <span class="math inline">\(probe_{IMB}\)</span> using these two profile, we get the following:</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="co"># --------------------------------------------</span>
<span class="no">probe_data_explosive</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3000</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">4</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.1</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="no">LPF_profile</span>
)


<span class="no">probe_data_slow</span> <span class="kw">&lt;-</span> <span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/probe_profile.html">probe_profile</a></span>(
  <span class="kw">mass</span> <span class="kw">=</span> <span class="fl">75</span>,
  <span class="kw">max_force</span> <span class="kw">=</span> <span class="fl">3000</span>,
  <span class="kw">max_velocity</span> <span class="kw">=</span> <span class="fl">4</span>,
  <span class="kw">time_to_max_activation</span> <span class="kw">=</span> <span class="fl">0.5</span>,
  <span class="kw">time_step</span> <span class="kw">=</span> <span class="fl">0.001</span>,
  <span class="kw">external_load</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>),
  <span class="kw">change_ratio</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">7</span>),

  <span class="co"># Profile variables</span>
  <span class="kw">profile_func</span> <span class="kw">=</span> <span class="no">LPF_profile</span>
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Explosive profile"</span>, <span class="no">probe_data_explosive</span>),
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">profile</span> <span class="kw">=</span> <span class="st">"Slow profile"</span>, <span class="no">probe_data_slow</span>)
)

<span class="no">probe_data</span> <span class="kw">&lt;-</span> <span class="fu">gather</span>(<span class="no">probe_data</span>, <span class="kw">key</span> <span class="kw">=</span> <span class="st">"variable"</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="st">"value"</span>, -(<span class="fl">1</span>:<span class="fl">9</span>))

<span class="no">gg</span> <span class="kw">&lt;-</span> <span class="fu">ggplot</span>(
  <span class="no">probe_data</span>,
  <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">change_ratio</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">value</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">probing</span>)
) +
  <span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>(<span class="fl">6</span>) +
  <span class="fu">geom_line</span>() +
  <span class="fu">facet_wrap</span>(<span class="no">profile</span> ~ <span class="no">variable</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">6</span>) +
  <span class="fu">xlab</span>(<span class="st">"Normalized parameter change"</span>) +
  <span class="fu">ylab</span>(<span class="st">"Estimator value"</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.8</span>, <span class="fl">1.4</span>))

<span class="fu"><a href="https://rdrr.io/pkg/directlabels/man/direct.label.html">direct.label</a></span>(<span class="no">gg</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"last.bumpup"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.4</span>))</pre></body></html></div>
<p><img src="optimization-vjsim_files/figure-html/unnamed-chunk-42-1.png" width="90%" style="display: block; margin: auto;"></p>
<p><span class="math inline">\(probe_{IMB}\)</span> shows similar values and similar behavior in both profiles, while LPF slope shows different values in each profile, but similar behavior. But can it tell us what we need to improve to reach higher vertical jump height? This will be further discussed in the <a href="https://mladenjovanovic.github.io/vjsim/articles/exploring-vjsim.html">exploring vignette</a>.</p>
<p>Similar idea to LPF slope concept is utilized with <em>Bosco Index</em> where the ratio of 2x BW jump height to BW jump height is calculated. Unfortunately, it seems that neither of these two (Bosco Index nor LPF slope) gives us a practical summary such as Samozino profile (i.e. using <span class="math inline">\(S_{FV}\%\)</span> or <span class="math inline">\(probe_{IMB}\)</span>) in terms what part of the “curve” one needs to improve to reach higher vertical jump height. It might be that these approaches evaluate optimality of different qualities of the Force Generator.</p>
<p>In the next <a href="https://mladenjovanovic.github.io/vjsim/articles/exploring-vjsim.html">exploring vignette</a> I will continue with the discussion and exploration of these model by using simulated data for a large amount of different combinations of Force Generator parameters. I will follow up with discussion of intervention studies using this model <span class="citation">(Jiménez-Reyes et al. <a href="#ref-jimenez-reyesEffectivenessIndividualizedTraining2017" role="doc-biblioref">2017</a>; Jiménez-Reyes, Samozino, and Morin <a href="#ref-jimenez-reyesOptimizedTrainingJumping2019" role="doc-biblioref">2019</a>)</span> and provide final conclusion about it’s application.</p>
</div>
</div>
<div id="shiny-app" class="section level1">
<h1 class="hasAnchor">
<a href="#shiny-app" class="anchor"></a>Shiny App</h1>
<p>Now start playing with the code or with the <a href="https://athletess.shinyapps.io/shiny-simulator/">Shiny App</a> by click on the previous link or by running the following code:</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="kw pkg">vjsim</span><span class="kw ns">::</span><span class="fu"><a href="../reference/run_simulator.html">run_simulator</a></span>()</pre></body></html></div>
<p>The <a href="https://athletess.shinyapps.io/shiny-simulator/">Shiny App</a> will allow you much more interactive environment for exploring the <code>vjsim</code>.</p>
</div>
<div id="want-to-learn-more" class="section level1">
<h1 class="hasAnchor">
<a href="#want-to-learn-more" class="anchor"></a>Want to learn more?</h1>
<p>Please continue by reading <a href="https://mladenjovanovic.github.io/vjsim/articles/exploring-vjsim.html">Exploring vignette</a>:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span>(<span class="st">"exploring-vjsim"</span>)</pre></body></html></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-cleatherForcevelocityProfilingMisnomer2019">
<p>Cleather, Daniel. 2019. “Force-Velocity Profiling Is a Misnomer: Load-Jump Height Profiling Would Be a Better Name.” Preprint. SportRxiv. <a href="https://doi.org/10.31236/osf.io/58fu3">https://doi.org/10.31236/osf.io/58fu3</a>.</p>
</div>
<div id="ref-jimenez-reyesEffectivenessIndividualizedTraining2017">
<p>Jiménez-Reyes, Pedro, Pierre Samozino, Matt Brughelli, and Jean-Benoît Morin. 2017. “Effectiveness of an Individualized Training Based on Force-Velocity Profiling During Jumping.” <em>Frontiers in Physiology</em> 7 (January). <a href="https://doi.org/10.3389/fphys.2016.00677">https://doi.org/10.3389/fphys.2016.00677</a>.</p>
</div>
<div id="ref-jimenez-reyesOptimizedTrainingJumping2019">
<p>Jiménez-Reyes, Pedro, Pierre Samozino, and Jean-Benoît Morin. 2019. “Optimized Training for Jumping Performance Using the Force-Velocity Imbalance: Individual Adaptation Kinetics.” Edited by Daniel Boullosa. <em>PLOS ONE</em> 14 (5): e0216681. <a href="https://doi.org/10.1371/journal.pone.0216681">https://doi.org/10.1371/journal.pone.0216681</a>.</p>
</div>
<div id="ref-samozinoForceVelocityProfileImbalance2013">
<p>Samozino, P., P. Edouard, S. Sangnier, M. Brughelli, P. Gimenez, and J.-B. Morin. 2013. “Force-Velocity Profile: Imbalance Determination and Effect on Lower Limb Ballistic Performance.” <em>International Journal of Sports Medicine</em> 35 (06): 505–10. <a href="https://doi.org/10.1055/s-0033-1354382">https://doi.org/10.1055/s-0033-1354382</a>.</p>
</div>
<div id="ref-samozinoSimpleMethodMeasuring2018">
<p>Samozino, Pierre. 2018a. “A Simple Method for Measuring Lower Limb Force, Velocity and Power Capabilities During Jumping.” In <em>Biomechanics of Training and Testing</em>, edited by Jean-Benoit Morin and Pierre Samozino, 65–96. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-05633-3_4">https://doi.org/10.1007/978-3-319-05633-3_4</a>.</p>
</div>
<div id="ref-samozinoOptimalForceVelocityProfile2018">
<p>———. 2018b. “Optimal Force-Velocity Profile in Ballistic Push-Off: Measurement and Relationship with Performance.” In <em>Biomechanics of Training and Testing</em>, edited by Jean-Benoit Morin and Pierre Samozino, 97–119. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-05633-3_5">https://doi.org/10.1007/978-3-319-05633-3_5</a>.</p>
</div>
<div id="ref-samozinoSimpleMethodMeasuring2008">
<p>Samozino, Pierre, Jean-Benoît Morin, Frédérique Hintzy, and Alain Belli. 2008. “A Simple Method for Measuring Force, Velocity and Power Output During Squat Jump.” <em>Journal of Biomechanics</em> 41 (14): 2940–5. <a href="https://doi.org/10.1016/j.jbiomech.2008.07.028">https://doi.org/10.1016/j.jbiomech.2008.07.028</a>.</p>
</div>
<div id="ref-samozinoJumpingAbilityTheoretical2010">
<p>Samozino, Pierre, Jean-Benoît Morin, Frédérique Hintzy, and Alain Belli. 2010. “Jumping Ability: A Theoretical Integrative Approach.” <em>Journal of Theoretical Biology</em> 264 (1): 11–18. <a href="https://doi.org/10.1016/j.jtbi.2010.01.021">https://doi.org/10.1016/j.jtbi.2010.01.021</a>.</p>
</div>
<div id="ref-samozinoOptimalForceVelocity2012">
<p>Samozino, Pierre, Enrico Rejc, Pietro Enrico Di Prampero, Alain Belli, and Jean-Benoît Morin. 2012. “Optimal Force–Velocity Profile in Ballistic Movements—Altius: Citius or Fortius?” <em>Medicine &amp; Science in Sports &amp; Exercise</em> 44 (2): 313–22. <a href="https://doi.org/10.1249/MSS.0b013e31822d757a">https://doi.org/10.1249/MSS.0b013e31822d757a</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p><code>bmbstats</code> package and accompanying book are currently in development, but you can access them on GitHub: <a href="https://github.com/mladenjovanovic/bmbstats" class="uri">https://github.com/mladenjovanovic/bmbstats</a> and <a href="https://github.com/mladenjovanovic/bmbstats-book" class="uri">https://github.com/mladenjovanovic/bmbstats-book</a>. The <code>bmbstats</code> book can be read on the GitHub pages: <a href="https://mladenjovanovic.github.io/bmbstats-book/" class="uri">https://mladenjovanovic.github.io/bmbstats-book/</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mladen Jovanović.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
